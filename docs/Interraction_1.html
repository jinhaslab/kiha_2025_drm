<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; 상호작용 – 직업환경연구방법</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./summary.html" rel="next">
<link href="./Jobstress.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-a8378a0342da607bf6aa9ac04725c156.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-424117795b1f6bc5b90be9cdae97709d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Interraction_1.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">상호작용</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">직업환경연구방법</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">소개</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">개요</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MetaAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">메타분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Dose_Response_Model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Dose Response Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./timeseries_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">시계열분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterruptedTS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">중단된 시계열 분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Jobstress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">job stress questionnaires</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Interraction_1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">상호작용</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#서론" id="toc-서론" class="nav-link active" data-scroll-target="#서론"><span class="header-section-number">7.1</span> 서론</a>
  <ul class="collapse">
  <li><a href="#주요-목표" id="toc-주요-목표" class="nav-link" data-scroll-target="#주요-목표"><span class="header-section-number">7.1.1</span> 주요 목표</a></li>
  </ul></li>
  <li><a href="#상호작용이란" id="toc-상호작용이란" class="nav-link" data-scroll-target="#상호작용이란"><span class="header-section-number">7.2</span> 상호작용이란?</a>
  <ul class="collapse">
  <li><a href="#상호작용의-동기" id="toc-상호작용의-동기" class="nav-link" data-scroll-target="#상호작용의-동기"><span class="header-section-number">7.2.1</span> 상호작용의 동기</a></li>
  </ul></li>
  <li><a href="#상호작용의-척도" id="toc-상호작용의-척도" class="nav-link" data-scroll-target="#상호작용의-척도"><span class="header-section-number">7.3</span> 상호작용의 척도</a>
  <ul class="collapse">
  <li><a href="#가법-상호작용" id="toc-가법-상호작용" class="nav-link" data-scroll-target="#가법-상호작용"><span class="header-section-number">7.3.1</span> 가법 상호작용</a></li>
  <li><a href="#승법-상호작용" id="toc-승법-상호작용" class="nav-link" data-scroll-target="#승법-상호작용"><span class="header-section-number">7.3.2</span> 승법 상호작용</a></li>
  <li><a href="#가법-vs-승법-공중보건적-관점" id="toc-가법-vs-승법-공중보건적-관점" class="nav-link" data-scroll-target="#가법-vs-승법-공중보건적-관점"><span class="header-section-number">7.3.3</span> 가법 vs 승법: 공중보건적 관점</a></li>
  <li><a href="#가법-상호작용-추정-reri와-통계적-모델" id="toc-가법-상호작용-추정-reri와-통계적-모델" class="nav-link" data-scroll-target="#가법-상호작용-추정-reri와-통계적-모델"><span class="header-section-number">7.3.4</span> 가법 상호작용 추정: RERI와 통계적 모델</a></li>
  <li><a href="#연속형-및-범주형-노출에서의-상호작용" id="toc-연속형-및-범주형-노출에서의-상호작용" class="nav-link" data-scroll-target="#연속형-및-범주형-노출에서의-상호작용"><span class="header-section-number">7.3.5</span> 연속형 및 범주형 노출에서의 상호작용</a></li>
  </ul></li>
  <li><a href="#r을-사용한-상호작용-분석" id="toc-r을-사용한-상호작용-분석" class="nav-link" data-scroll-target="#r을-사용한-상호작용-분석"><span class="header-section-number">7.4</span> R을 사용한 상호작용 분석</a>
  <ul class="collapse">
  <li><a href="#r-코드-이진-노출에-대한-가법-상호작용" id="toc-r-코드-이진-노출에-대한-가법-상호작용" class="nav-link" data-scroll-target="#r-코드-이진-노출에-대한-가법-상호작용"><span class="header-section-number">7.4.1</span> R 코드: 이진 노출에 대한 가법 상호작용</a></li>
  <li><a href="#r-코드-연속형-노출에-대한-가법-상호작용" id="toc-r-코드-연속형-노출에-대한-가법-상호작용" class="nav-link" data-scroll-target="#r-코드-연속형-노출에-대한-가법-상호작용"><span class="header-section-number">7.4.2</span> R 코드: 연속형 노출에 대한 가법 상호작용</a></li>
  <li><a href="#r-코드-범주형-노출에-대한-가법-상호작용" id="toc-r-코드-범주형-노출에-대한-가법-상호작용" class="nav-link" data-scroll-target="#r-코드-범주형-노출에-대한-가법-상호작용"><span class="header-section-number">7.4.3</span> R 코드: 범주형 노출에 대한 가법 상호작용</a></li>
  </ul></li>
  <li><a href="#결론" id="toc-결론" class="nav-link" data-scroll-target="#결론"><span class="header-section-number">7.5</span> 결론</a>
  <ul class="collapse">
  <li><a href="#참고문헌" id="toc-참고문헌" class="nav-link" data-scroll-target="#참고문헌"><span class="header-section-number">7.5.1</span> 참고문헌</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">상호작용</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="서론" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="서론"><span class="header-section-number">7.1</span> 서론</h2>
<p>이 강의록은 VanderWeele와 Knol의 논문 <em>“A Tutorial on Interaction”</em> (Epidemiol. Methods 2014; 3(1): 33-72)을 기반으로 작성되었습니다. 상호작용(interaction)은 한 노출(exposure)의 효과가 다른 노출의 존재 여부에 따라 달라지는 현상을 의미합니다. 이 현상은 역학, 생물의학, 사회과학 등 다양한 분야에서 중요한 연구 주제입니다. 본 강의록에서는 상호작용의 개념, 동기, 척도별 분석 방법, 통계 모델, 그리고 실제 적용 사례를 다룹니다.</p>
<section id="주요-목표" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="주요-목표"><span class="header-section-number">7.1.1</span> 주요 목표</h3>
<ul>
<li>상호작용의 정의와 중요성을 이해한다.</li>
<li>가법(additive) 및 승법(multiplicative) 척도에서의 상호작용 분석 방법을 학습한다.</li>
<li>통계 모델을 활용한 상호작용 추정 방법을 익힌다.</li>
<li>공중보건적 관점에서 상호작용의 해석을 이해한다.</li>
</ul>
<hr>
</section>
</section>
<section id="상호작용이란" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="상호작용이란"><span class="header-section-number">7.2</span> 상호작용이란?</h2>
<p>상호작용은 두 노출(<span class="math inline">\(G\)</span>, <span class="math inline">\(E\)</span>)이 결과(<span class="math inline">\(D\)</span>)에 미치는 효과가 서로 독립적이지 않고, 한 노출의 효과가 다른 노출의 수준에 따라 달라지는 경우를 말합니다. 예를 들어, 흡연과 석면 노출이 폐암 위험에 미치는 영향은 두 요인이 함께 존재할 때 더욱 크게 나타날 수 있습니다.</p>
<section id="상호작용의-동기" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="상호작용의-동기"><span class="header-section-number">7.2.1</span> 상호작용의 동기</h3>
<p>상호작용 연구는 여러 이유로 중요합니다: 1. <strong>자원 할당 최적화</strong>: 제한된 자원으로 특정 집단에 개입할 때, 효과가 큰 하위집단을 식별할 수 있다. 2. <strong>기전 이해</strong>: 상호작용은 결과 발생 메커니즘에 대한 통찰을 제공할 수 있다. 3. <strong>검정력 향상</strong>: 상호작용을 고려하면 전체 효과를 탐지하는 검정력이 높아질 수 있다. 4. <strong>부작용 방지</strong>: 특정 집단에서 개입이 해로울 수 있는 경우를 식별한다.</p>
<hr>
</section>
</section>
<section id="상호작용의-척도" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="상호작용의-척도"><span class="header-section-number">7.3</span> 상호작용의 척도</h2>
<p>상호작용은 가법 척도와 승법 척도에서 다르게 정의됩니다. 두 이진 노출(<span class="math inline">\(G\)</span>, <span class="math inline">\(E\)</span>)과 이진 결과(<span class="math inline">\(D\)</span>)를 기준으로 설명합니다. 여기서 <span class="math inline">\(p_{ge} = P(D=1 \mid G=g, E=e)\)</span>는 <span class="math inline">\(G=g\)</span>, <span class="math inline">\(E=e\)</span>일 때 결과가 발생할 확률입니다.</p>
<section id="가법-상호작용" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="가법-상호작용"><span class="header-section-number">7.3.1</span> 가법 상호작용</h3>
<p>가법 상호작용은 두 노출의 공동 효과가 각 노출의 개별 효과의 합을 초과하는지를 평가합니다. 수식은 다음과 같습니다:</p>
<p><span class="math display">\[p_{11} - p_{10} - p_{01} + p_{00}\]</span></p>
<ul>
<li><strong>양의 가법 상호작용</strong>: 위 값이 0보다 크면 “super-additive”라 부릅니다.</li>
<li><strong>음의 가법 상호작용</strong>: 0보다 작으면 “sub-additive”라 부릅니다.</li>
</ul>
<p><strong>예시: 흡연과 석면 노출</strong></p>
<p>Hilt et al.&nbsp;(1986)의 데이터를 사용하여 계산해 보겠습니다.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>석면 없음</th>
<th>석면 있음</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>비흡연자</td>
<td>0.0011</td>
<td>0.0067</td>
</tr>
<tr class="even">
<td>흡연자</td>
<td>0.0095</td>
<td>0.0450</td>
</tr>
</tbody>
</table>
<p>가법 상호작용 계산:</p>
<p><span class="math display">\[ p\_{11} - p\_{10} - p\_{01} + p\_{00} = 0.0450 - 0.0095 - 0.0067 + 0.0011 = 0.0299 \]</span></p>
<p>결과는 양의 가법 상호작용을 나타냅니다.</p>
</section>
<section id="승법-상호작용" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="승법-상호작용"><span class="header-section-number">7.3.2</span> 승법 상호작용</h3>
<p>승법 상호작용은 위험비(risk ratio, RR) 또는 오즈비(odds ratio, OR)를 기준으로 두 노출의 공동 효과가 각 노출의 개별 효과의 곱을 초과하는지를 평가합니다. 위험비 기준 수식은 다음과 같습니다:</p>
<p><span class="math display">\[ \frac{RR_{11}}{RR_{10} \cdot RR_{01}} = \frac{p_{11} \cdot p_{00}}{p_{10} \cdot p_{01}} \]</span></p>
<ul>
<li><strong>양의 승법 상호작용</strong>: 위 값이 1보다 크면 양의 상호작용입니다.</li>
<li><strong>음의 승법 상호작용</strong>: 1보다 작으면 음의 상호작용입니다.</li>
</ul>
<p>위 예시 데이터를 사용하여 승법 상호작용을 계산:</p>
<p><span class="math display">\[ RR\_{11} = \frac{0.0450}{0.0011}, \quad RR\_{10} = \frac{0.0095}{0.0011}, \quad RR\_{01} = \frac{0.0067}{0.0011} \]</span></p>
<p><span class="math display">\[ \frac{RR_{11}}{RR_{10} \cdot RR_{01}} = \frac{40.9}{8.6 \times 6.1} = 0.78 \]</span></p>
<p>결과는 음의 승법 상호작용을 나타냅니다.</p>
</section>
<section id="가법-vs-승법-공중보건적-관점" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="가법-vs-승법-공중보건적-관점"><span class="header-section-number">7.3.3</span> 가법 vs 승법: 공중보건적 관점</h3>
<ul>
<li><strong>가법 상호작용</strong>은 공중보건적 의사결정에 더 적합합니다. 예를 들어, 자원이 제한적일 때 가법 상호작용이 양이면 특정 하위집단(<span class="math inline">\(G=1\)</span>)에 개입하는 것이 더 큰 효과를 가져옵니다.</li>
<li><strong>승법 상호작용</strong>은 통계적 모델링(특히 로지스틱 회귀)에서 편리하지만, 기준 위험(baseline risk)의 차이로 인해 잘못된 하위집단을 선택할 수 있습니다.</li>
</ul>
<hr>
</section>
<section id="가법-상호작용-추정-reri와-통계적-모델" class="level3" data-number="7.3.4">
<h3 data-number="7.3.4" class="anchored" data-anchor-id="가법-상호작용-추정-reri와-통계적-모델"><span class="header-section-number">7.3.4</span> 가법 상호작용 추정: RERI와 통계적 모델</h3>
<p>가법 상호작용은 직접적인 위험 차이(<span class="math inline">\(p_{11} - p_{10} - p_{01} + p_{00}\)</span>)를 계산하기 어려운 경우, <strong>상대초과위험(Relative Excess Risk due to Interaction, RERI)</strong>을 사용하여 추정합니다. RERI는 위험비 또는 오즈비를 기반으로 정의됩니다:</p>
<p><span class="math display">\[
RERI_{RR} = RR_{11} - RR_{10} - RR_{01} + 1
\]</span></p>
<p>로지스틱 회귀를 사용할 경우, 오즈비 기반 RERI는 다음과 같이 계산됩니다:</p>
<p><span class="math display">\[
RERI_{OR} = e^{\gamma_1 + \gamma_2 + \gamma_3} - e^{\gamma_1} - e^{\gamma_2} + 1
\]</span></p>
<p>여기서 <span class="math inline">\(\gamma_1\)</span>, <span class="math inline">\(\gamma_2\)</span>, <span class="math inline">\(\gamma_3\)</span>는 로지스틱 회귀 모델의 계수입니다:</p>
<p><span class="math display">\[
\log \text{it} \{ P(D=1 \mid G=g, E=e, C=c) \} = \gamma_0 + \gamma_1 g + \gamma_2 e + \gamma_3 eg + \gamma_4' c
\]</span></p>
<ul>
<li><strong>장점</strong>: 로지스틱 회귀는 연속형 공변량(<span class="math inline">\(C\)</span>)이 포함된 경우에도 수렴 문제가 적으며, 사례-대조 연구(case-control study)에서도 사용 가능합니다.</li>
<li><strong>주의점</strong>: 결과가 흔한 경우(<span class="math inline">\(&gt;10\%\)</span>), <span class="math inline">\(RERI_{OR}\)</span>은 <span class="math inline">\(RERI_{RR}\)</span>을 정확히 근사하지 못할 수 있습니다. 이 경우 로그선형 모델이나 수정된 포아송 회귀를 고려할 수 있습니다.</li>
</ul>
<section id="reri의-공중보건적-해석" class="level4" data-number="7.3.4.1">
<h4 data-number="7.3.4.1" class="anchored" data-anchor-id="reri의-공중보건적-해석"><span class="header-section-number">7.3.4.1</span> RERI의 공중보건적 해석</h4>
<ul>
<li><span class="math inline">\(RERI &gt; 0\)</span>: <span class="math inline">\(G=1\)</span> 집단에서 <span class="math inline">\(E\)</span>에 대한 개입이 더 큰 공중보건적 효과를 가짐.</li>
<li><span class="math inline">\(RERI &lt; 0\)</span>: <span class="math inline">\(G=0\)</span> 집단에서 <span class="math inline">\(E\)</span>에 대한 개입이 더 효과적.</li>
<li><span class="math inline">\(RERI = 0\)</span>: 두 집단 간 개입 효과 차이 없음.</li>
</ul>
</section>
</section>
<section id="연속형-및-범주형-노출에서의-상호작용" class="level3" data-number="7.3.5">
<h3 data-number="7.3.5" class="anchored" data-anchor-id="연속형-및-범주형-노출에서의-상호작용"><span class="header-section-number">7.3.5</span> 연속형 및 범주형 노출에서의 상호작용</h3>
<section id="연속형-노출" class="level4" data-number="7.3.5.1">
<h4 data-number="7.3.5.1" class="anchored" data-anchor-id="연속형-노출"><span class="header-section-number">7.3.5.1</span> 연속형 노출</h4>
<p>연속형 노출(<span class="math inline">\(G\)</span>, <span class="math inline">\(E\)</span>)의 경우, RERI는 특정 수준 간 변화(예: <span class="math inline">\(G\)</span>가 <span class="math inline">\(g_0\)</span>에서 <span class="math inline">\(g_1\)</span>로, <span class="math inline">\(E\)</span>가 <span class="math inline">\(e_0\)</span>에서 <span class="math inline">\(e_1\)</span>로)를 기준으로 계산됩니다:</p>
<p><span class="math display">\[
RERI_{OR} = e^{(\gamma_1 (g_1 - g_0) + \gamma_2 (e_1 - e_0) + \gamma_3 (g_1 e_1 - g_0 e_0))} - e^{(\gamma_1 (g_1 - g_0) + \gamma_3 (g_1 - g_0) e_0)} - e^{(\gamma_2 (e_1 - e_0) + \gamma_3 (e_1 - e_0) g_0)} + 1
\]</span></p>
<p><strong>주의</strong>: - RERI는 비교하는 수준(<span class="math inline">\(g_0, g_1\)</span>, <span class="math inline">\(e_0, e_1\)</span>)에 따라 달라질 수 있습니다. - 절대 위험의 가법 상호작용 크기와 RERI의 크기는 기준 위험(<span class="math inline">\(p_{00}\)</span>)에 따라 달라질 수 있으므로, 방향(양/음/0)만 해석하는 것이 안전합니다.</p>
</section>
<section id="범주형-노출" class="level4" data-number="7.3.5.2">
<h4 data-number="7.3.5.2" class="anchored" data-anchor-id="범주형-노출"><span class="header-section-number">7.3.5.2</span> 범주형 노출</h4>
<p>범주형 노출의 경우, 두 수준 간 비교를 위해 데이터를 제한하여 이진 노출처럼 분석합니다. 예를 들어, 노출 <span class="math inline">\(A\)</span> (수준: A1, A2, A3)와 <span class="math inline">\(B\)</span> (수준: B1, B2, B3, B4)를 비교할 때, A1 vs A2와 B1 vs B4를 선택하여 분석합니다.</p>
<hr>
</section>
</section>
</section>
<section id="r을-사용한-상호작용-분석" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="r을-사용한-상호작용-분석"><span class="header-section-number">7.4</span> R을 사용한 상호작용 분석</h2>
<p>R을 사용하여 가법 상호작용(RERI)을 추정하는 방법을 소개합니다. <code>glm()</code>으로 로지스틱 회귀를 수행하고, <code>car</code> 패키지의 <code>deltaMethod()</code>로 RERI와 신뢰구간을 계산합니다.</p>
<section id="r-코드-이진-노출에-대한-가법-상호작용" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="r-코드-이진-노출에-대한-가법-상호작용"><span class="header-section-number">7.4.1</span> R 코드: 이진 노출에 대한 가법 상호작용</h3>
<p>다음은 이진 노출(<span class="math inline">\(G\)</span>, <span class="math inline">\(E\)</span>)에 대한 RERI 추정 코드입니다. 데이터프레임 <code>mydata</code>에 결과 변수 <code>d</code>, 노출 변수 <code>g</code>, <code>e</code>, 공변량 <code>c1</code>, <code>c2</code>, <code>c3</code>가 포함되어 있다고 가정합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 패키지 로드</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 시뮬레이션</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># 결과 재현을 위해 시드 설정</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>N_binary <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># 샘플 크기</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 공변량 생성</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>c1_bin <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N_binary, <span class="dv">50</span>, <span class="dv">10</span>) <span class="co"># 예: 나이</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>c2_bin <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N_binary, <span class="dv">1</span>, <span class="fl">0.4</span>) <span class="co"># 예: 성별 (0 또는 1)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>c3_bin <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N_binary, <span class="dv">25</span>, <span class="dv">5</span>)  <span class="co"># 예: BMI</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#c1_bin</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 이진 노출 G와 E 생성 (서로 약간의 상관관계가 있을 수 있도록 시뮬레이션)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>g_bin_latent <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N_binary)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>e_bin_latent <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="sc">*</span> g_bin_latent <span class="sc">+</span> <span class="fu">rnorm</span>(N_binary) <span class="co"># g와 e 간 약한 상관관계 부여</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>g_bin <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(g_bin_latent <span class="sc">&gt;</span> <span class="fu">median</span>(g_bin_latent), <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># 이진화</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>e_bin <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(e_bin_latent <span class="sc">&gt;</span> <span class="fu">median</span>(e_bin_latent), <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># 이진화</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 변수 d 생성 (로지스틱 모델 기반)</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># logit(P(d=1)) = beta0 + beta_g*g + beta_e*e + beta_ge*g*e + beta_c1*c1 + beta_c2*c2 ...</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># RERI_OR = exp(beta_g + beta_e + beta_ge) - exp(beta_g) - exp(beta_e) + 1</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 목표 RERI_OR = 0.5 (예시)</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># exp(beta_g)=1.5, exp(beta_e)=1.2 이면,</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># exp(beta_g + beta_e + beta_ge) = 0.5 + 1.5 + 1.2 - 1 = 2.2</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># beta_g = log(1.5) approx 0.405</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># beta_e = log(1.2) approx 0.182</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># beta_ge = log(2.2) - log(1.5) - log(1.2) = log(2.2 / (1.5 * 1.2)) = log(2.2/1.8) = log(1.222) approx 0.200</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>log_odds_bin <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span> <span class="sc">+</span> <span class="fl">0.405</span><span class="sc">*</span>g_bin <span class="sc">+</span> <span class="fl">0.182</span><span class="sc">*</span>e_bin <span class="sc">+</span> <span class="fl">0.200</span><span class="sc">*</span>g_bin<span class="sc">*</span>e_bin <span class="sc">+</span> <span class="fl">0.02</span><span class="sc">*</span>c1_bin <span class="sc">-</span> <span class="fl">0.1</span><span class="sc">*</span>c2_bin <span class="sc">+</span> <span class="fl">0.01</span><span class="sc">*</span>c3_bin</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>prob_d_bin <span class="ot">&lt;-</span> <span class="fu">plogis</span>(log_odds_bin) <span class="co"># plogis는 1/(1+exp(-x))와 동일 (로지스틱 함수)</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>d_bin <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N_binary, <span class="dv">1</span>, prob_d_bin)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>mydata_binary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d_bin, <span class="at">g =</span> g_bin, <span class="at">e =</span> e_bin, <span class="at">c1 =</span> c1_bin, <span class="at">c2 =</span> c2_bin, <span class="at">c3 =</span> c3_bin)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 로지스틱 회귀 모델 적합</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># d ~ g + e + g*e + c1 + c2 + c3 (g*e가 g:e와 동일)</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 주의: 모델 계수의 순서가 parameterNames와 일치해야 함.</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co"># (Intercept), g, e, c1, c2, c3, g:e 순으로 나오는 경향이 있음.</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co"># 명시적으로 순서를 맞추려면 g + e + c1 + c2 + c3 + g:e 와 같이 인터랙션 항을 뒤로.</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 또는 parameterNames를 names(coef(model_binary))로 하고, 수식에서 실제 변수명 사용.</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co"># 여기서는 사용자님의 parameterNames 방식("b0"..."b6")을 따르기 위해,</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co"># g:e 항이 4번째 예측변수(b3)가 되도록 모델 정의.</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>model_binary <span class="ot">&lt;-</span> <span class="fu">glm</span>(d <span class="sc">~</span> g <span class="sc">+</span> e <span class="sc">+</span> g<span class="sc">:</span>e <span class="sc">+</span> c1 <span class="sc">+</span> c2 <span class="sc">+</span> c3,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">data =</span> mydata_binary)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Binary Model Summary:"</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model_binary))</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co"># RERI_OR 계산 (deltaMethod 사용)</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co"># parameterNames 순서: (Intercept), g, e, g:e, c1, c2, c3</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 따라서 b0=(Intercept), b1=g, b2=e, b3=g:e, b4=c1, b5=c2, b6=c3</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># deltaMethod에서 사용하는 b1,b2,b3는 G, E, G:E의 계수를 의미함.</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># names(coef(model_binary))를 확인하여 b1,b2,b3가 어떤 계수인지 정확히 파악해야함.</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co"># 만약 g, e, g:e가 모델에서 2, 3, 7번째 계수라면 (Intercept 포함)</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co"># parameterNames = names(coef(model_binary))로 하고, 수식에서 실제 변수명을 사용하는 것이 더 안전.</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co"># 그러나 사용자님 코드의 parameterNames 방식(b0, b1...)을 따름.</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co"># 이 경우 g, e, g:e가 각각 b1, b2, b3에 해당함 (Intercept가 b0).</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>param_names_bin <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"b"</span>, <span class="dv">0</span><span class="sc">:</span>(<span class="fu">length</span>(<span class="fu">coef</span>(model_binary))<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Binary Model RERI_OR Calculation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>reri_binary <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deltaMethod</span>(model_binary,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>              <span class="st">"exp(b1 + b2 + b3) - exp(b1) - exp(b2) + 1"</span>,</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>              <span class="at">parameterNames =</span> param_names_bin)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>}, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Error in deltaMethod for binary model: "</span>, <span class="fu">conditionMessage</span>(e), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Check coefficient names and parameterNames argument.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Coefficients from model: "</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_binary)), <span class="at">collapse=</span><span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Expected parameterNames: "</span>, <span class="fu">paste</span>(param_names_bin, <span class="at">collapse=</span><span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(reri_binary)) {</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(reri_binary)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-코드-연속형-노출에-대한-가법-상호작용" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="r-코드-연속형-노출에-대한-가법-상호작용"><span class="header-section-number">7.4.2</span> R 코드: 연속형 노출에 대한 가법 상호작용</h3>
<p>연속형 노출의 경우, 비교 수준(예: <span class="math inline">\(G\)</span>가 0에서 2로, <span class="math inline">\(E\)</span>가 5에서 25로)을 지정하여 RERI를 계산합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 시뮬레이션</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>N_continuous <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>c1_cont <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N_continuous, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>c2_cont <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N_continuous, <span class="dv">1</span>, <span class="fl">0.4</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>c3_cont <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N_continuous, <span class="dv">25</span>, <span class="dv">5</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 연속형 노출 G와 E 생성</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>g_cont <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N_continuous, <span class="dv">10</span>, <span class="dv">2</span>) <span class="co"># 예: 노출 농도</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>e_cont <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N_continuous, <span class="dv">20</span>, <span class="dv">5</span>) <span class="co"># 예: 노출 기간</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 변수 d 생성 (연속형 노출을 사용한 로지스틱 모델 기반)</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># logit(P(d=1)) = beta0 + beta_g*g + beta_e*e + beta_ge*g*e + ...</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>log_odds_cont <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.05</span><span class="sc">*</span>g_cont <span class="sc">+</span> <span class="fl">0.02</span><span class="sc">*</span>e_cont <span class="sc">+</span> <span class="fl">0.001</span><span class="sc">*</span>g_cont<span class="sc">*</span>e_cont <span class="sc">+</span> <span class="fl">0.03</span><span class="sc">*</span>c1_cont <span class="sc">-</span> <span class="fl">0.2</span><span class="sc">*</span>c2_cont <span class="sc">+</span> <span class="fl">0.01</span><span class="sc">*</span>c3_cont</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>prob_d_cont <span class="ot">&lt;-</span> <span class="fu">plogis</span>(log_odds_cont)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>d_cont <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N_continuous, <span class="dv">1</span>, prob_d_cont)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>mydata_continuous <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d_cont, <span class="at">g =</span> g_cont, <span class="at">e =</span> e_cont,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                                <span class="at">c1 =</span> c1_cont, <span class="at">c2 =</span> c2_cont, <span class="at">c3 =</span> c3_cont)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 비교 수준 지정</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>g0 <span class="ot">&lt;-</span> <span class="dv">5</span>; g1 <span class="ot">&lt;-</span> <span class="dv">15</span>  <span class="co"># g가 5에서 15로 변할 때</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>e0 <span class="ot">&lt;-</span> <span class="dv">10</span>; e1 <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="co"># e가 10에서 30으로 변할 때</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 로지스틱 회귀 모델 적합</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>model_continuous <span class="ot">&lt;-</span> <span class="fu">glm</span>(d <span class="sc">~</span> g <span class="sc">+</span> e <span class="sc">+</span> g<span class="sc">:</span>e <span class="sc">+</span> c1 <span class="sc">+</span> c2 <span class="sc">+</span> c3,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                        <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">data =</span> mydata_continuous)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Continuous Model Summary:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Continuous Model Summary:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model_continuous))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = d ~ g + e + g:e + c1 + c2 + c3, family = binomial(link = "logit"), 
    data = mydata_continuous)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept) -7.736915   2.486636  -3.111  0.00186 **
g            0.247759   0.224382   1.104  0.26951   
e            0.145378   0.109010   1.334  0.18233   
c1           0.028906   0.010434   2.770  0.00560 **
c2          -0.164807   0.207894  -0.793  0.42793   
c3           0.012149   0.020841   0.583  0.55993   
g:e         -0.007472   0.010456  -0.715  0.47480   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 709.59  on 999  degrees of freedom
Residual deviance: 686.15  on 993  degrees of freedom
AIC: 700.15

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RERI_OR 계산 (deltaMethod 사용)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 사용자님의 강의록에 있는 RERI 공식 사용</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># RERI_OR = exp(gamma1*(g1-g0) + gamma2*(e1-e0) + gamma3*(g1*e1 - g0*e0))</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#           - exp(gamma1*(g1-g0) + gamma3*(g1-g0)*e0)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#           - exp(gamma2*(e1-e0) + gamma3*(e1-e0)*g0) + 1</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 여기서 gamma1, gamma2, gamma3는 모델의 g, e, g:e 계수 (b1, b2, b3에 해당)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>reri_formula_cont <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"exp( b1*(%f-%f) + b2*(%f-%f) + b3*((%f*%f) - (%f*%f)) ) - exp( b1*(%f-%f) + b3*((%f-%f)*%f) ) - exp( b2*(%f-%f) + b3*((%f-%f)*%f) ) + 1"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  g1, g0, e1, e0, g1, e1, g0, e0,  <span class="co"># term for OR11</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  g1, g0, g1, g0, e0,              <span class="co"># term for OR10 (effect of G at E=e0)</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  e1, e0, e1, e0, g0               <span class="co"># term for OR01 (effect of E at G=g0)</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>param_names_cont <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"b"</span>, <span class="dv">0</span><span class="sc">:</span>(<span class="fu">length</span>(<span class="fu">coef</span>(model_continuous))<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Continuous Model RERI_OR Calculation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Continuous Model RERI_OR Calculation:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Formula used for deltaMethod:</span><span class="sc">\n</span><span class="st">"</span>, reri_formula_cont, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula used for deltaMethod:
 exp( b1*(15.000000-5.000000) + b2*(30.000000-10.000000) + b3*((15.000000*30.000000) - (5.000000*10.000000)) ) - exp( b1*(15.000000-5.000000) + b3*((15.000000-5.000000)*10.000000) ) - exp( b2*(30.000000-10.000000) + b3*((30.000000-10.000000)*5.000000) ) + 1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>reri_continuous <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deltaMethod</span>(model_continuous, reri_formula_cont, <span class="at">parameterNames =</span> param_names_cont)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>}, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Error in deltaMethod for continuous model: "</span>, <span class="fu">conditionMessage</span>(e), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Check coefficient names and parameterNames argument.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Coefficients from model: "</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_continuous)), <span class="at">collapse=</span><span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Expected parameterNames: "</span>, <span class="fu">paste</span>(param_names_cont, <span class="at">collapse=</span><span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Error in deltaMethod for continuous model:  함수 "deltaMethod"를 찾을 수 없습니다 
Check coefficient names and parameterNames argument.
Coefficients from model:  (Intercept), g, e, c1, c2, c3, g:e 
Expected parameterNames:  b0, b1, b2, b3, b4, b5, b6 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(reri_continuous)) {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(reri_continuous)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-코드-범주형-노출에-대한-가법-상호작용" class="level3" data-number="7.4.3">
<h3 data-number="7.4.3" class="anchored" data-anchor-id="r-코드-범주형-노출에-대한-가법-상호작용"><span class="header-section-number">7.4.3</span> R 코드: 범주형 노출에 대한 가법 상호작용</h3>
<p>범주형 노출의 경우, 특정 수준 쌍을 선택하여 이진 노출처럼 분석합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 시뮬레이션</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>N_categorical <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>c1_cat <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N_categorical, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>c2_cat <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N_categorical, <span class="dv">1</span>, <span class="fl">0.4</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>c3_cat <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N_categorical, <span class="dv">25</span>, <span class="dv">5</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 범주형 노출 A (3수준), B (4수준) 생성</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>A_cat <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>), N_categorical, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>)))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>B_cat <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"B3"</span>, <span class="st">"B4"</span>), N_categorical, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>)))</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 변수 d 생성</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A1&amp;B1을 참조로 가정.</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># A2 vs A1, A3 vs A1 효과, B2 vs B1, B3 vs B1, B4 vs B1 효과</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># A2&amp;B2 에서의 상호작용 등...</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 단순화를 위해, A와 B의 특정 조합에 따라 확률 부여</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>log_odds_cat <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span> <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(A_cat <span class="sc">==</span> <span class="st">"A2"</span>, <span class="fl">0.5</span>, <span class="fu">ifelse</span>(A_cat <span class="sc">==</span> <span class="st">"A3"</span>, <span class="fl">0.8</span>, <span class="dv">0</span>)) <span class="sc">+</span> <span class="co"># A 주효과 (A1 대비)</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(B_cat <span class="sc">==</span> <span class="st">"B2"</span>, <span class="fl">0.3</span>, <span class="fu">ifelse</span>(B_cat <span class="sc">==</span> <span class="st">"B3"</span>, <span class="fl">0.6</span>, <span class="fu">ifelse</span>(B_cat <span class="sc">==</span> <span class="st">"B4"</span>, <span class="fl">0.9</span>, <span class="dv">0</span>))) <span class="sc">+</span> <span class="co"># B 주효과 (B1 대비)</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(A_cat <span class="sc">==</span> <span class="st">"A2"</span> <span class="sc">&amp;</span> B_cat <span class="sc">==</span> <span class="st">"B4"</span>, <span class="fl">0.7</span>, <span class="dv">0</span>) <span class="sc">+</span> <span class="co"># A2와 B4 간의 상호작용 (예시)</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.01</span><span class="sc">*</span>c1_cat <span class="sc">-</span> <span class="fl">0.15</span><span class="sc">*</span>c2_cat <span class="sc">+</span> <span class="fl">0.005</span><span class="sc">*</span>c3_cat</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>prob_d_cat <span class="ot">&lt;-</span> <span class="fu">plogis</span>(log_odds_cat)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>d_cat <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N_categorical, <span class="dv">1</span>, prob_d_cat)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>mydata_categorical_full <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d_cat, <span class="at">A =</span> A_cat, <span class="at">B =</span> B_cat,</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">c1 =</span> c1_cat, <span class="at">c2 =</span> c2_cat, <span class="at">c3 =</span> c3_cat)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 분석: A1 vs A2 (A1이 참조), B1 vs B4 (B1이 참조) 간의 상호작용</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>mydata_subset <span class="ot">&lt;-</span> mydata_categorical_full <span class="sc">%&gt;%</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(A <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"A2"</span>) <span class="sc">&amp;</span> B <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B4"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">g =</span> <span class="fu">ifelse</span>(A <span class="sc">==</span> <span class="st">"A2"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="co"># A1 (ref=0) vs A2 (exp=1)</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">e =</span> <span class="fu">ifelse</span>(B <span class="sc">==</span> <span class="st">"B4"</span>, <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co"># B1 (ref=0) vs B4 (exp=1)</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 로지스틱 회귀 모델 적합 (부분집합 사용)</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>model_categorical_subset <span class="ot">&lt;-</span> <span class="fu">glm</span>(d <span class="sc">~</span> g <span class="sc">+</span> e <span class="sc">+</span> g<span class="sc">:</span>e <span class="sc">+</span> c1 <span class="sc">+</span> c2 <span class="sc">+</span> c3,</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>                                <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">data =</span> mydata_subset)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Categorical (Subset) Model Summary:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Categorical (Subset) Model Summary:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model_categorical_subset))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = d ~ g + e + g:e + c1 + c2 + c3, family = binomial(link = "logit"), 
    data = mydata_subset)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept) -3.21280    1.00167  -3.207  0.00134 **
g            0.30290    0.38467   0.787  0.43102   
e            0.50806    0.37314   1.362  0.17333   
c1           0.01736    0.01300   1.335  0.18173   
c2           0.03761    0.27245   0.138  0.89022   
c3           0.02237    0.02685   0.833  0.40481   
g:e          1.67984    0.53494   3.140  0.00169 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 413.78  on 353  degrees of freedom
Residual deviance: 355.37  on 347  degrees of freedom
AIC: 369.37

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RERI_OR 계산 (deltaMethod 사용 - 이진 노출과 동일한 방식)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>param_names_cat_subset <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"b"</span>, <span class="dv">0</span><span class="sc">:</span>(<span class="fu">length</span>(<span class="fu">coef</span>(model_categorical_subset))<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Categorical (Subset) Model RERI_OR Calculation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Categorical (Subset) Model RERI_OR Calculation:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>reri_categorical_subset <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deltaMethod</span>(model_categorical_subset,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"exp(b1 + b2 + b3) - exp(b1) - exp(b2) + 1"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">parameterNames =</span> param_names_cat_subset)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>}, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Error in deltaMethod for categorical (subset) model: "</span>, <span class="fu">conditionMessage</span>(e), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Check coefficient names and parameterNames argument.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Coefficients from model: "</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_categorical_subset)), <span class="at">collapse=</span><span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Expected parameterNames: "</span>, <span class="fu">paste</span>(param_names_cat_subset, <span class="at">collapse=</span><span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Error in deltaMethod for categorical (subset) model:  함수 "deltaMethod"를 찾을 수 없습니다 
Check coefficient names and parameterNames argument.
Coefficients from model:  (Intercept), g, e, c1, c2, c3, g:e 
Expected parameterNames:  b0, b1, b2, b3, b4, b5, b6 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(reri_categorical_subset)) {</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(reri_categorical_subset)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># RERI와 신뢰구간 계산을 위한 대안: `interactionR` 패키지</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># `interactionR` 패키지는 로지스틱 회귀 모델 객체를 직접 사용하여 RERI(ICR로 표시), AP 등 다양한</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 상호작용 척도와 그 신뢰구간을 계산해 줄 수 있습니다.</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 사용법 예시:</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># model_for_ir &lt;- glm(d ~ g_bin + e_bin + g_bin:e_bin + c1 + c2 + c3,</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                     data = mydata_binary, family = binomial)</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># interaction_measures_result &lt;- interactionR::interaction.ratios(model_for_ir)</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print(interaction_measures_result)</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 이 패키지는 특히 신뢰구간 계산에 유용합니다.</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># deltaMethod를 직접 사용하는 것보다 복잡한 수식 없이 결과를 얻을 수 있습니다.</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 단, exposure_names 등의 인자를 모델에 맞게 정확히 지정해야 합니다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="결론" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="결론"><span class="header-section-number">7.5</span> 결론</h2>
<p>상호작용 분석은 역학 연구에서 공중보건적 의사결정과 기전 이해에 필수적입니다. 가법 상호작용(RERI)은 자원 할당 최적화에 유용하며, 승법 상호작용은 로지스틱 회귀를 통한 통계적 분석에 적합합니다. R을 사용한 실습 코드는 이진, 연속형, 범주형 노출에 대한 RERI 추정을 지원하며, <code>car</code> 패키지의 <code>deltaMethod()</code>를 활용해 신뢰구간을 계산합니다. 두 척도를 함께 보고하여 종합적인 해석을 제공하는 것이 권장됩니다.</p>
<section id="참고문헌" class="level3" data-number="7.5.1">
<h3 data-number="7.5.1" class="anchored" data-anchor-id="참고문헌"><span class="header-section-number">7.5.1</span> 참고문헌</h3>
<ul>
<li>VanderWeele, T. J., &amp; Knol, M. J. (2014). A Tutorial on Interaction. <em>Epidemiologic Methods</em>, 3(1), 33-72.</li>
<li>Rothman, K. J. (1986). <em>Modern Epidemiology</em>. Boston, MA: Little, Brown and Company.</li>
<li>Greenland, S., Lash, T. L., &amp; Rothman, K. J. (2008). <em>Modern Epidemiology</em>. Philadelphia, PA: Lippincott Williams and Wilkins.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Jobstress.html" class="pagination-link" aria-label="job stress questionnaires">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">job stress questionnaires</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./summary.html" class="pagination-link" aria-label="Summary">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>