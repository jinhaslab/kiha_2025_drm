[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "2025년 하계 산업보건학회",
    "section": "",
    "text": "소개\n2025년 하계 산업보건학회 PDC 강의록입니다.\nflyinyou@gmail.com",
    "crumbs": [
      "소개"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  개요",
    "section": "",
    "text": "2 1.서론",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>개요</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model.html",
    "href": "Dose_Response_Model.html",
    "title": "2  Dose Response Model I",
    "section": "",
    "text": "2.1 Exposure (Dose) and Health\nif(!require(tidyverse)) install.packages(\"tidyverse\")\nif(!require(ggplot2)) install.packages(\"ggplot2\")\nif(!require(knitr)) install.packages(\"knitr\")\nif(!require(kableExtra)) install.packages(\"kableExtra\")\n우리몸에 필수 요소가 있다고 상상해 봅시다. 예를 들어 적혈구 백혈구를 생각해 보는 것입니다. 적혈구가 너무 적으면 빈혈과 같은 질병이 있는 것이고, 너무 많으면 적혈구 과다증이 있어 건강에 해롭습니다.  어떤 필수 요소가 너무 적거나 많은 상태를 질병으로, 적절한 양이 있는 경우 건강상태로 보는 것 입니다. 다음과 같은 상황을 상상해 보겠습니다.\ntrace.e &lt;- seq(1,50, by=0.1)\n#normal range = 15~35\ntrace.e.h=function (x) {\n  ifelse(x&lt;20, 1/(1+exp(-x+10)),\n         ifelse(x&lt;30, rnorm(1, 1/(1+exp(-19)), 0.01), \n                1/(1+exp(-19))-1/(1+exp(40-x))\n                )\n        )\n  }\nhstatus&lt;-trace.e.h(trace.e)+rnorm(length(trace.e), 1, 0.1)\nbasic = tibble(trace.e, hstatus)\n이러한 관계를 그림으로 그려 보겠습니다. 기능적 측면에서 생물학적 필수 요소가 너무 적거나 너무 많으면 사망하거나 질병이 있는 상태로, 절적 수준이 유지되는 것을 정상상태로 볼 수 있습니다.\nbasic %&gt;%\n  ggplot(aes(x= trace.e, y = hstatus)) +\n  scale_x_continuous(name=\"Biological Element\") +\n  scale_y_continuous(name=\"Function\") +\n  theme_minimal()+\n  geom_rect(data=basic[1,],aes(xmin=-Inf, xmax=7 , ymin=-Inf, ymax=Inf), fill= 'grey', alpha=0.8) +\n  geom_rect(data=basic[1,],aes(xmin=7,    xmax=15, ymin=-Inf, ymax=Inf), fill= 'grey', alpha=0.5) +\n  geom_rect(data=basic[1,],aes(xmin=15,   xmax=35, ymin=-Inf, ymax=Inf), fill= 'grey', alpha=0.3) +\n  geom_rect(data=basic[1,],aes(xmin=35,   xmax=43, ymin=-Inf, ymax=Inf), fill= 'grey', alpha=0.5) +\n  geom_rect(data=basic[1,],aes(xmin=43,   xmax=52, ymin=-Inf, ymax=Inf), fill= 'grey', alpha=0.8) +\n  geom_point(size=1, color = 'grey50') +\n  annotate(geom=\"text\", x=c(3,47),  y=c(1.3, 1.3), label=\"Death\",    color=\"red\") +\n  annotate(geom=\"text\", x=c(10,38), y=c(1.5, 1.5), label=\"Disease\",  color=\"black\") +\n  annotate(geom=\"text\", x=25,       y=1.7,         label=\"Normal Function\",color=\"blue\")\n위의 그림을 Y축을 적혈구의 기능 측면에서 본 것으로 상상해보면 이해가 갑니다. 다음에는 적혈구의 가능을 악화시키는 물질에 노출되었다고 상상하고 기능이 아닌 질병 측면에서 볼 수 있습니다. 거꾸로 그래프를 뒤집을 수 있습니다.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dose Response Model I</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model.html#exposure-dose-and-health",
    "href": "Dose_Response_Model.html#exposure-dose-and-health",
    "title": "2  Dose Response Model I",
    "section": "",
    "text": "자료 생성\n\n\n\n그림 그리기",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dose Response Model I</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model.html#실습-1-질병-그림-그리기",
    "href": "Dose_Response_Model.html#실습-1-질병-그림-그리기",
    "title": "2  Dose Response Model I",
    "section": "2.2 실습 1: 질병 그림 그리기",
    "text": "2.2 실습 1: 질병 그림 그리기\n\nbasic = basic %&gt;% \n  mutate(disease = -1*hstatus+5, \n         exp.b   = -1*trace.e +50) \n\nfig1 = basic  %&gt;%\n  ggplot(aes(x= exp.b, y = disease))+\n  theme_minimal()+\n  scale_x_continuous(name=\"Biomarker\") +\n  scale_y_continuous(name=\"Disease\") +\n  geom_rect(data=basic[1,],aes(xmin=-Inf, xmax=7 , ymin=-Inf, ymax=Inf), fill= 'grey', alpha=0.8) +\n  geom_rect(data=basic[1,],aes(xmin=7,    xmax=15, ymin=-Inf, ymax=Inf), fill= 'grey', alpha=0.5) +\n  geom_rect(data=basic[1,],aes(xmin=15,   xmax=35, ymin=-Inf, ymax=Inf), fill= 'grey', alpha=0.3) +\n  geom_rect(data=basic[1,],aes(xmin=35,   xmax=43, ymin=-Inf, ymax=Inf), fill= 'grey', alpha=0.5) +\n  geom_rect(data=basic[1,],aes(xmin=43,   xmax=52, ymin=-Inf, ymax=Inf), fill= 'grey', alpha=0.8) +\n  geom_point(size=1, color = 'orange') +\n  annotate(geom=\"text\", x=c(3,47),  y=c(3.7, 3.7), label=\"Death\",    color=\"red\") +\n  annotate(geom=\"text\", x=c(10,38), y=c(3.5, 3.5), label=\"Disease\",  color=\"black\") +\n  annotate(geom=\"text\", x=25,       y=3.3,         label=\"Normal Function\",color=\"blue\") \nfig1",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dose Response Model I</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model.html#지역사회-연구-community-base-cohort-study",
    "href": "Dose_Response_Model.html#지역사회-연구-community-base-cohort-study",
    "title": "2  Dose Response Model I",
    "section": "2.3 지역사회 연구 (community base cohort study)",
    "text": "2.3 지역사회 연구 (community base cohort study)\n지역사회 연구에서는 질병이 있는 사람 또는 기능이 약화된 사람은 병원에 입원해 있는 등 사회생활이 어려우므로 참여하지 못할 수 있습니다. 따라서 장기간 추적 관찰을 하지 않는 경우 바이오마커와 질병간에 U-shap 을 보이게 됩니다. 장기 관찰을 하거나 충분한 관찰을 하면 질병이 새로 생기는 부분을 찾을 수 있으므로 J-shap으로 보일 수 도 있습니다. 우리가 과거력이 있는 사람 또는 적절한 방법으로 건강이 악화되어 있는 사람을 제외하는 경우 바이오마커와 질병의 선형적 관계를 관찰할 수 있는 경우 입니다.\n\nfig1 +\n  annotate(geom=\"text\", x=c(7, 43),  y=c(3.3, 3.3), label=\"Hospital (selection bias)\",  color=\"grey50\") +\n  annotate(geom=\"text\", x=c(10),  y=c(3.8), label=\"Short term follow up\",  color=\"purple\") +\n  geom_segment(aes(x=10, xend=40, y=3.7, yend=3.7), size = 0.5, color='grey50',\n               arrow = arrow(length = unit(0.2, \"cm\"), type = \"closed\")) +\n  annotate(geom=\"text\", x=c(30),  y=c(4.1), label=\"Long term follow up\",  color=\"purple\") +\n  geom_segment(aes(x=10, xend=50, y=4, yend=4), size = 0.5, color='grey50',\n               arrow = arrow(length = unit(0.2, \"cm\"), type = \"closed\"))\n\n\n\n\n\n\n\n\n  산업보건에서는 건강한 근로자가 직장을 갖고 직장을 갖은 후에 일에 따라 물리화학적 인자에 노출이 됩니다. 만약 위의 그림에서 바이오마커가 일을하면서 노출되는 유해인자와 관련이 있다면, 사업장에서는 바이오마커가 매우 낮은 사람은 없을 것입니다. 그리고 유해인자에 노출이 많이 되어 질병이 생기고 병원에 가게된다면, 사업장을 중심으로 연구하는 경우 연구대상에 참여하지 못하게 됩니다. 즉 위의 그림에서 short-term follow up 의 상황이 발생하게 됩니다. 그런데 장기간 관찰하고 퇴사후의 자료도 이용한다면 long term follow up 과 같이 가게됩니다. 이때 상관 분석을 수행하면 short-term follow up에서는 U-shap으로, long term follow up 에서는 J-shap 으로 나타나게 됩니다. 실제 연구에서도 비슷한 상황이 발생하기도 합니다. 이때 우리가 얻은 데이터가 무엇을 목적으로 어떠한 설계로 만들어 졌는지를 관찰하고 정말 질병이 생길만한 사람을 제외한 현장에서 연구를 수행하고 있는 것은 아닌지 고민해 보아야 합니다.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dose Response Model I</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model.html#모형-차이-sigmoid-curve-vs-linear-regression",
    "href": "Dose_Response_Model.html#모형-차이-sigmoid-curve-vs-linear-regression",
    "title": "2  Dose Response Model I",
    "section": "2.4 모형 차이: sigmoid curve vs linear regression",
    "text": "2.4 모형 차이: sigmoid curve vs linear regression\n  위의 그래프를 절반을 나누어서 적절한 기능을 하고 있는 사람만을 대상으로 장기간 추적관찰했다고 가정해 보겠습니다. 그러면 바이오마커와 질병의 관계를 선형으로 예측할 수도 있습니다. 노출이 지속되더라도 건강의 악화는 어느정도 포화될수 있으므로 (모두 다 계속 사망하지는 않으므로) 노출의 크기와 질병의 관계는 sigmoid curve 관계가 있을 수 있습니다.\n  어떤게 좋을까요? 정답은 없지만 LD50을 고려해서 생각해 보겠습니다. LD50이란 노출된 사람 중의 50%가 사망하는 농도를 의미합니다. 즉 LD50가 큰 물질은 적은 물질보다 많이 노출되어야 노출된 사람 중의 50%가 사망하므로 더 안전한 물질입니다.\n\nsigmoid.f = function(x){\n  1/(1+exp(5-x))\n}\n\ndf = tibble(\ndose.e = c(1:10),  \nresp   = sigmoid.f(dose.e)\n)\ndf %&gt;% kbl() %&gt;%\n  kable_paper(\"hover\", full_width = F)\n\n\n\n\ndose.e\nresp\n\n\n\n\n1\n0.0179862\n\n\n2\n0.0474259\n\n\n3\n0.1192029\n\n\n4\n0.2689414\n\n\n5\n0.5000000\n\n\n6\n0.7310586\n\n\n7\n0.8807971\n\n\n8\n0.9525741\n\n\n9\n0.9820138\n\n\n10\n0.9933071\n\n\n\n\n\n\nplot(df)\n\n\n\n\n\n\n\n\nLD50은 설명을 했고, 과도한 비교를 위해서 LD70을 보고 이야기 해보겠습니다.\n\nset.seed(50)\nx&lt;-seq(0, 10, 0.01)\ny&lt;-sigmoid.f(x)+rnorm(length(x), mean=0, sd=0.1)\npb&lt;-c(rnorm(500, 0, 0.001), rnorm(300, 0, 0.01), rnorm(100, 0.1, 0.05),rnorm(101, -0.1, 0.05))\nresp = y + pb\nld70.sm = x[which( sigmoid.f(x) &gt;0.69 & sigmoid.f(x) &lt; 0.71)] %&gt;% min(.)\nld70.sm\n\n[1] 5.81\n\nmod1&lt;-glm(resp ~ poly(x, 1))\npred1&lt;-predict(mod1)\nld70.lm = x[which(pred1 &gt;0.69 & pred1 &lt;0.71)] %&gt;% min(.)\nld70.lm\n\n[1] 6.47\n\ndf = tibble(dose = x, response= resp)\ndf %&gt;%\n  ggplot(aes(x=dose, y=response)) +\n  geom_point(color = 'grey80') + theme_minimal()+\n  geom_line(aes(y= sigmoid.f(dose)), color ='red') +\n  geom_line(aes(y= predict(lm(response ~ poly(dose, 1)))), color ='blue') +\n  geom_vline(xintercept =   5, linetype=2, color='grey50') +\n  geom_hline(yintercept = 0.7, linetype=2, color='grey50') +\n  annotate(geom=\"text\", x=ld70.sm -1,  y=0.9, label=\"LD70\",  \n           color=\"purple\", hjust=1) +\n  geom_segment(aes(x=ld70.sm -1, xend=ld70.sm, y=0.85, yend=0.7), size = 0.1, color='grey30',\n               arrow = arrow(length = unit(0.2, \"cm\"), type = \"closed\")) +\n  annotate(geom=\"text\", x=ld70.lm +1,  y=0.0, label=\"LD70 by linear assumption\",  \n           color=\"purple\", hjust=0) +\n  geom_segment(aes(x=ld70.lm +1, xend=ld70.lm, y=0.05, yend=0.7), size = 0.1, color='grey30',\n               arrow = arrow(length = unit(0.2, \"cm\"), type = \"closed\"))\n\n\n\n\n\n\n\n\n가상의 자료입니다. 그래도 중요하게 기억할 점은 선형과 비선형 커브로 할 경우 LD70이 달라지고, 독성에 대한 설명이 달라집니다. 따라서 어떠한 방식으로 설명할지 꼭 고민해야 합니다.  저 농도나 고농도에서는 더 큰 차이가 나타납니다. 그런데 대 부분 저농도의 노동자 들이나 고농도 노출의 노동자가 연구에 참여하기 어려운 상황이 발생합니다. 앞서 계속해서 이야기하는 건강근로자 효과 등을 상기 시켜 봅시다.  그럼 어떤 모델이 가장 적당할 까요? 우선 모델 적합도를 설명도로 비교해 볼 수 있습니다.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dose Response Model I</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model.html#코호트-특성에-따른-상황",
    "href": "Dose_Response_Model.html#코호트-특성에-따른-상황",
    "title": "2  Dose Response Model I",
    "section": "2.5 코호트 특성에 따른 상황",
    "text": "2.5 코호트 특성에 따른 상황\n첫 수업 시간에 이야기한 것 처럼, 처음에는 질병이 생긴 노동자 위주로 연구가 진행되게 됩니다. 따라서 고농도 노출자 이면서 질병이 있는 사람으로 구성된 데이터에서는 상대적으로 높은 농도에서 질병이 발생하는 연구 결과과 발표 되기도 합니다. 그리고 그림에서 보듯이 선형관계를 고민하지 않는 다면 어디를 기준으로 해야할지 알 수 없는 상태입니다.  결론적으로 위험하다 는 알수 있지만, 얼마나 위험하다는 아직 연구가 되지 않은 상태라는 것을 기억해야 합니다.\n\nearly_cohort = df %&gt;% filter(dose &gt; 5)\n\ndf %&gt;%\n  ggplot(aes(x=dose, y=response)) +\n  geom_point(color = 'grey80') + theme_minimal()+\n  geom_line(aes(y= sigmoid.f(dose)), color ='red') +\n  geom_line(aes(y= predict(lm(response ~ dose))), color ='blue') +\n  geom_vline(xintercept =   5, linetype=2, color='grey50') +\n  geom_hline(yintercept = 0.7, linetype=2, color='grey50') +\n  ## add 1 \n  annotate(geom=\"text\", x=c(7.5),  y=c(-0.2), \n           label=\"Early cohort (hospital base)\",  color=\"purple\", hjust=0) +\n  geom_rect(data=df[1,],aes(xmin=-Inf,   xmax=5, ymin=-Inf, ymax=Inf), \n            fill= 'grey', alpha=0.6) +\n  geom_line(data= early_cohort,\n              aes(y= predict(lm(response ~ poly(dose,3)))), color ='orange', size = 2) +\n   annotate(geom=\"text\", x=ld70.sm -1,  y=0.9, label=\"LD70\",  \n           color=\"purple\", hjust=1) +\n  geom_segment(aes(x=ld70.sm -1, xend=ld70.sm, y=0.85, yend=0.7), size = 0.1, color='grey30',\n               arrow = arrow(length = unit(0.2, \"cm\"), type = \"closed\")) +\n  annotate(geom=\"text\", x=ld70.lm +1,  y=0.0, label=\"LD70 by linear assumption\",  \n           color=\"purple\", hjust=0) +\n  geom_segment(aes(x=ld70.lm +1, xend=ld70.lm, y=0.05, yend=0.7), size = 0.1, color='grey30',\n               arrow = arrow(length = unit(0.2, \"cm\"), type = \"closed\"))",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dose Response Model I</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model.html#코호트-특성에-따른-상황과-이론적-모델",
    "href": "Dose_Response_Model.html#코호트-특성에-따른-상황과-이론적-모델",
    "title": "2  Dose Response Model I",
    "section": "2.6 코호트 특성에 따른 상황과 이론적 모델",
    "text": "2.6 코호트 특성에 따른 상황과 이론적 모델\n어느정도 잘 갖추어진 코호트를 생각해 보겠습니다. Dose 2 부터 노출된 사람을 대상으로 하였다고 가정하겠습니다.\n\n# subcohort 2nd phase (1st phase is hospital base cohort)\ns2c &lt;- df %&gt;% filter(dose &gt;2)\ns2m1&lt;-lm(data=s2c, response ~ poly(dose, 1))\ns2m2&lt;-lm(data=s2c, response ~ poly(dose, 2))\ns2m3&lt;-lm(data=s2c, response ~ poly(dose, 3))\ns2m4&lt;-lm(data=s2c, response ~ poly(dose, 4))\n\ndf %&gt;%\n  ggplot(aes(x=dose, y=response)) +\n  geom_point(color = 'grey80') + theme_minimal()+\n  geom_point(data=s2c, color = 'grey40', size =2   ) +\n  geom_line(data=s2c, aes(y=predict(s2m1)), color = 'chocolate1', size = 1) +\n  geom_line(data=s2c, aes(y=predict(s2m2)), color = 'chartreuse1', size = 1) +\n  geom_line(data=s2c, aes(y=predict(s2m3)), color = 'cadetblue1', size = 1) +\n  geom_line(data=s2c, aes(y=predict(s2m4)), color = 'deeppink1', size = 1) \n\n\n\n\n\n\n\n\n모델로 보면 선형 예측이 모형 적합도가 가장 낮다(low)고 나타나고 차수가 높을 수록 좋다고 나타나고 있습니다. 그런데, 어떤게 더 맞을 까요?.\n\nanova(s2m1, s2m2, s2m3, s2m4) \n\nAnalysis of Variance Table\n\nModel 1: response ~ poly(dose, 1)\nModel 2: response ~ poly(dose, 2)\nModel 3: response ~ poly(dose, 3)\nModel 4: response ~ poly(dose, 4)\n  Res.Df     RSS Df Sum of Sq        F  Pr(&gt;F)    \n1    798 18.9099                                  \n2    797 13.4734  1    5.4365 440.8574 &lt; 2e-16 ***\n3    796  9.8806  1    3.5928 291.3455 &lt; 2e-16 ***\n4    795  9.8036  1    0.0770   6.2423 0.01267 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n만약 농도가 높을 때 낮아지고 있는 부분을 고려한다면 어떻게 될까요? (실제로도 농도가 높은 곳에 근무하는 노동자는 만성 질병이 일어나기 전에 손상으로 사망하는 연구가 있습니다. ) 따라서 그런 산업보건적 특성을 고려하면 어떻게 될 까요? 단순하게 9 이상 농도를 고려하지 않도록 하겠습니다.\n\ns3c &lt;- df %&gt;% filter(dose &gt;2) %&gt;% filter(dose &lt;9)\ns3m1&lt;-lm(data=s3c, response ~ poly(dose, 1))\ns3m2&lt;-lm(data=s3c, response ~ poly(dose, 2))\ns3m3&lt;-lm(data=s3c, response ~ poly(dose, 3))\ns3m4&lt;-lm(data=s3c, response ~ poly(dose, 4))\n\ndf %&gt;%\n  ggplot(aes(x=dose, y=response)) +\n  geom_point(color = 'grey80') + theme_minimal()+\n  geom_point(data=s3c, color = 'grey40', size =2   ) +\n  #geom_line(data=s2c, aes(y=predict(s2m1)), color = 'grey30', size = 1) +\n  geom_line(data=s2c, aes(y=predict(s2m4)), color = 'grey30', size = 1) +\n  #geom_line(data=s3c, aes(y=predict(s3m1)), color = 'orange', size = 1) \n  geom_line(data=s3c, aes(y=predict(s3m4)), color = 'orange', size = 1) \n\n\n\n\n\n\n\ndf %&gt;%\n  ggplot(aes(x=dose, y=response)) +\n  geom_point(color = 'grey80') + theme_minimal()+\n  geom_point(data=s3c, color = 'grey40', size =2   ) +\n  geom_line(data=s2c, aes(y=predict(s2m1)), color = 'grey30', size = 1) +\n  #geom_line(data=s2c, aes(y=predict(s2m4)), color = 'grey30', size = 1) +\n  geom_line(data=s3c, aes(y=predict(s3m1)), color = 'orange', size = 1) \n\n\n\n\n\n\n\n  #geom_line(data=s3c, aes(y=predict(s3m4)), color = 'orange', size = 1) \n\n3차 이상의 모형에서는 큰 차이가 나지 않지만, 선형 모형에서는 차이가 상당합니다. 어떤 것이 더 맞다는 것은 아직 논할 단계는 아니고, 차이가 있다는 것을 기억하면 좋겠습니다. 그래서 실제 보고하고 적용할 때 현장에 더 적합한 것이 무엇인지, 목적이 보호 인지, 보상인지 등을 고려하여 해야 겠습니다.\n\nlibrary(gam)\n######전체 자료 실습\ns4c = df %&gt;% filter(dose &lt;9)\ns4m1&lt;-lm(data=s4c, response ~ poly(dose, 1))\ns4m3&lt;-lm(data=s4c, response ~ poly(dose, 3))\ns4ms&lt;-lm(data=s4c, response ~ sigmoid.f(dose-5))\ns4mg&lt;-gam(data=s4c, response ~ s(dose, 20))\nanova(s4m1, s4m3, s4ms, s4mg)\n\nAnalysis of Variance Table\n\nModel 1: response ~ poly(dose, 1)\nModel 2: response ~ poly(dose, 3)\nModel 3: response ~ sigmoid.f(dose - 5)\nModel 4: response ~ s(dose, 20)\n  Res.Df    RSS     Df Sum of Sq       F    Pr(&gt;F)    \n1    898 14.876                                       \n2    896 10.064  2.000     4.812  233.61 &lt; 2.2e-16 ***\n3    898 67.272 -2.000   -57.208 2777.26 &lt; 2.2e-16 ***\n4    879  9.053 18.999    58.219  297.52 &lt; 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\ndf %&gt;%\n  ggplot(aes(x=dose, y=response)) +\n  geom_point(color = 'grey80') + theme_minimal()+\n  geom_point(data=s4c, color = 'grey40', size =2   ) +\n  geom_line(data=s4c, aes(y=predict(s4m1)), color = 'grey10', size = 1) +\n  geom_line(data=s4c, aes(y=predict(s4m3)), color = 'grey30', size = 1) +\n  geom_line(data=s4c, aes(y=predict(s4ms)), color = 'deepskyblue', size = 1) +\n  geom_line(data=s4c, aes(y=predict(s4mg)), color = 'orange', size = 1) \n\n\n\n\n\n\n\n\n\n2.6.1 Take home message\n\n고 노출 집단:\n\n\n높은 표준 사망비(SMR)에도 불구하고 용량 증가에 따른 질병 발생 증가 경향이 명확하지 않을 수 있습니다. 즉, 선형적인 용량-반응 관계가 나타나지 않을 수 있습니다.\n\n\n중간 용량 노출 집단:\n\n\n용량-반응 관계가 관찰되지만, 건강한 노동자 효과로 인해 실제 관계가 약화될 수 있습니다. 즉, 실제보다 용량과 질병 발생 간의 연관성이 낮게 나타날 수 있습니다.\n\n\n전체 용량 노출 집단:\n\n\n용량-반응 관계를 분석하고, 건강한 노동자 효과를 통제하여 더욱 정확한 결과를 얻을 수 있습니다.\n모델 선택 과정에서 LD50(반수 치사량)의 과대 또는 과소 평가가 발생할 수 있으므로 주의해야 합니다.\n최적의 모델이라 하더라도, 건강한 노동자 효과로 인한 데이터 편향 때문에 실제 질병 발생 양상을 완벽하게 반영하지 못할 수 있습니다.\n\n\n권고 사항: 기존 모델에 의존하기보다는, 연구 특성에 맞는 자체적인 용량-반응 모델을 개발하여 적용하는 것이 바람직합니다.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dose Response Model I</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model.html#threshold-찾기-change-point-찾기",
    "href": "Dose_Response_Model.html#threshold-찾기-change-point-찾기",
    "title": "2  Dose Response Model I",
    "section": "2.7 Threshold 찾기 (change point 찾기)",
    "text": "2.7 Threshold 찾기 (change point 찾기)\nthreshold를 찾는 방법 중에 threshold point마다, piecewise regression을 반복해서 구하고, 최적의 모델을 찾는 방법을 사용할 수 있습니다. piecewise regression 의 간단한 설명은 다음과 같습니다\n\n\n\n\n\n\n\nthreshold points (piecewise regression)\ncodes\n\n\n\n\ntotal\nResp = α + β1 · Dose + β2 ·( Dose – Ɵ) + + Ɛ0\n\n\nIf Dose &lt; Ɵ\nResp= α + β1 · Dose + Ɛ0\n\n\nIf Dose &gt; Ɵ\nResp= α - β2 ·Ɵ +( β1 + β2 )· Dose + Ɛ0\n\n\nmodel selection\nminimal AIC value\n\n\n\n\n2.7.1 자료 생성\n아래 처럼 임로 데이터를 생성해 보았습니다. 어떤 유해물질 노출 (Dose) 에 따라 건강영향 (Resp) 가 나타났다고 생각해 보겠습니다. 그리고 일정량에서 threshold가 있다고 생각해보겠습니다.\n\nset.seed(0)\ndose &lt;- seq(0,10, 0.1)\nlength(dose)\n\n[1] 101\n\npb&lt;-c(rnorm(50, 0, 0.001), rnorm(30, 0, 0.01), rnorm(10, 0.1, 0.05),rnorm(11, -0.1, 0.05))\nresp &lt;-1/(1+exp(-(dose-5)))+rnorm(length(dose), 0, 0.1)+pb\n\nplot(dose, resp, xlab='Dose', ylab='Response', cex.lab=1.5, cex.axis=1.5, cex.main=1.5, cex.sub=1.5)\n\n\n\n\n\n\n\ncohort&lt;-data.frame(dose, resp, pb)\n\n\n\n2.7.2 가상의 threshold 값 수행해보기\n한 1에서 5 사이에 있어 보입니다. 이를 통해 예상되는 matrix (outdata)를 구해보았습니다. outdata의 행의 이름을 threshold point에 따라 intercept, beta for before threshold, and its p value, beta for post threshold and its pvalue와 그때은 AIC 값을 구해보겠습니다 . 우선 하나만 구해보겠습니다. therhold가 1일때와 5일때를 를 가정해 보겠습니다.\n\ncpdose &lt;- ifelse(dose -1 &gt;0, dose -1, 0)\ncpm &lt;- glm(resp ~ dose + cpdose)\nsummary(cpm)$aic\n\n[1] -92.20184\n\n\n\ncpdose &lt;- ifelse(dose -5 &gt;0, dose -5, 0)\ncpm &lt;- glm(resp ~ dose + cpdose)\nsummary(cpm)$aic\n\n[1] -86.9744\n\n\n어떤 가정이 모델 적합도를 높이나요? 네 threshold가 1일 때 입니다. 그럼 2랑도, 2.5랑도 비교해 봐야겠지요. 이때 반복 분석을 수행해보도록 하겠습니다.\n위의 모델을 함수로 만들었습니다\n\nthr_fun &lt;- function(thres){\ncpdose &lt;- ifelse(dose - thres &gt;0, dose - thres, 0)\ncpm    &lt;- glm(resp ~ dose + cpdose)\naic    &lt;- summary(cpm)$aic\ndata.frame(\n  'threshold' = thres,\n  'aic'       = aic)\n}\n\n이것을 돌릴 범위를 정해보겠습니다.\n\n# 이게 어떤 의미 일까요?\ndose[which(dose == 1):which(dose == 5)]\n\n [1] 1.0 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2.0 2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8\n[20] 2.9 3.0 3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 4.0 4.1 4.2 4.3 4.4 4.5 4.6 4.7\n[39] 4.8 4.9 5.0\n\n\n이제 반복해서 작업해 보겠습니다.\n\nsimul_list &lt;- list()\nsimul_list &lt;- lapply(dose[which(dose ==1):which(dose ==5)],                     thr_fun\n                     )\n\n이제 데이터 프레임으로 만들어 보겠습니다.\n\nsimul_dat &lt;- do.call(rbind, simul_list)\n\n그림을 그려보겠습니다.\n\nlibrary(ggplot2)\nopt.thres &lt;- simul_dat$threshold[which.min(simul_dat$aic)]\n\nsimul_dat %&gt;%\n  ggplot(aes(x = threshold, y = aic)) +\n  geom_line() +\n  geom_vline(xintercept = opt.thres) +\n  geom_text(x = opt.thres + 0.8, y = -90, color = 'red', \n            label = paste0(round(opt.thres, 3), '점에서 최소 AIC를 보입니다.' )) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n즉 2.1에서 threshold를 잡아 모델을 그리면 가장 적합함을 알 수 있습니다.\n\nthres = 2.1\nf_cpdose &lt;- ifelse(dose - thres &gt;0, dose - thres, 0)\nf_cpm    &lt;- glm(resp ~ dose + f_cpdose)\n\n\nprepwlm &lt;- predict(f_cpm)\nscaleFUN &lt;- function(x) sprintf(\"%.2f\", x)\ncohort %&gt;%\n  ggplot(aes(x= dose, y = resp)) +\n  geom_point() +\n  theme_minimal() +\n  scale_y_continuous(labels = scaleFUN) +\n  geom_line(aes(y = prepwlm), color ='red')\n\n\n\n\n\n\n\n\n만약 threshold 전에는 질병이 생기지 않는다고 가정하면 어떻게 될가요? dose 대신 predose 를 넣어 주면 됩니다.\n\nthres = 2.1\nf_cpdose &lt;- ifelse(dose - thres &gt;=0, dose - thres, 0)\nf_predose &lt;- ifelse(dose - thres &lt;=0, 0, dose - thres )\nf_cpm    &lt;- glm(resp ~ f_predose + f_cpdose)\n\n\nprepwlm &lt;- predict(f_cpm)\nscaleFUN &lt;- function(x) sprintf(\"%.2f\", x)\ncohort %&gt;%\n  ggplot(aes(x= dose, y = resp)) +\n  geom_point() +\n  theme_minimal() +\n  scale_y_continuous(labels = scaleFUN) +\n  geom_line(aes(y = prepwlm), color ='red')",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Dose Response Model I</span>"
    ]
  },
  {
    "objectID": "intro.html#직업병-역학연구에서-용량반응-관계의-중요성",
    "href": "intro.html#직업병-역학연구에서-용량반응-관계의-중요성",
    "title": "1  개요",
    "section": "2.1 직업병 역학연구에서 용량반응 관계의 중요성",
    "text": "2.1 직업병 역학연구에서 용량반응 관계의 중요성\n직업병 역학연구에서 용량반응 관계는 특정 유해물질에 대한 노출량과 그로 인해 발생하는 질병 또는 건강 영향의 크기 사이의 연관성을 설명하는 근본적인 개념이다. 이 관계를 이해하는 것은 직업 및 환경 보건 분야에서 인과적 추론을 강화하고, 과학적 증거의 강점과 한계를 평가하며, 잠재적 위험을 정확하게 평가하는 데 필수적인 요소이다. \n용량반응 관계는 노출 수준이 증가함에 따라 유해 영향의 위험이 커진다는 점을 보여줌으로써, 특정 노출이 단순히 질병과 연관된 것이 아니라 질병 발생의 직접적인 원인이 될 가능성이 높다는 인과성 주장을 강력하게 뒷받침한다. 이러한 정량적인 연관성은 안전한 노출 한계 및 규제 표준을 설정하는 데 필요한 실질적인 근거를 제공하며, 공중 보건 개입의 우선순위를 효과적으로 결정하는 데 중요한 지침이 된다.\n본 강의는 직업병 역학연구에서 용량반응 관계의 중요성과, 이를 해석하는 과정에 내재된 복잡성과 다양한 도전 과제를 이해하고 실습하는 것을 목표로 한다. 특히, 유해물질 노출에 따른 질병 발생의 정량적 관계를 모델링하고 활용하는 과정에서 일반적으로 전제되는 주요 가정들, 즉 선형성, 노출과 용량의 관계, 노출 분포의 정규성, 질병 발생의 측정 가능성, 그리고 노출과 질병 관련성의 상호작용 부재와 같은 가정들이 실제 연구 환경에서 어떻게 위배될 수 있는지, 그리고 그로 인해 어떠한 문제점들이 발생하는지를 다룬다. \n또한, 이러한 문제점들을 해결하기 위한 고급 분석 기법과 정책적 함의를 제시함으로써, 직업병 역학연구의 과학적 엄밀성을 높이고, 근로자 건강 보호를 위한 실질적이고 효과적인 예방 전략 수립에 기여하고자 한다.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>개요</span>"
    ]
  },
  {
    "objectID": "intro.html#정의-및-인과성-확립-기여",
    "href": "intro.html#정의-및-인과성-확립-기여",
    "title": "1  개요",
    "section": "3.1 정의 및 인과성 확립 기여",
    "text": "3.1 정의 및 인과성 확립 기여\n용량반응 관계는 특정 유해 요인(예: 화학 물질, 방사선, 영양소)의 노출량 또는 수준과 그로 인한 건강 결과(예: 질병 발생률 또는 사망률) 간의 정량적인 연관성을 의미한다. 이 관계는 역학 연구의 핵심적인 요소로서, 다양한 노출 수준이 건강 결과에 어떻게 영향을 미치는지를 이해하기 위한 기본적인 논리를 제공한다.\n용량반응 관계의 확립은 노출과 결과 간의 인과 관계를 입증하는 증거 중 하나로 간주된다. 노출이 증가함에 따라 유해 효과의 위험이 증가한다는 명확한 용량반응 기울기(Gradient)는 인과성을 뒷받침하는 핵심적인 요소이다. 단순히 통계적 연관성을 넘어, 브래드포드 힐(Bradford Hill)의 인과성 기준 중 하나인 ’생물학적 기울기(Biological Gradient)’에 해당된다. \n표 1 . 브래포드 힐의 인과관계 요소\n\n\n\n요소\n영어 표기\n\n\n\n\n연관성의 강도\nStrength of association\n\n\n일관성\nConsistency\n\n\n특이성\nSpecificity\n\n\n시간적 선후 관계\nTemporality\n\n\n용량-반응 관계\nDose-response\n\n\n생물학적 그럴듯성\nPlausibility\n\n\n일치성\nCoherence\n\n\n실험\nExperiment\n\n\n유추\nAnalogy\n\n\n\n이는 노출량의 체계적인 변화가 건강 결과의 변화를 유도한다는 것을 보여주며, 인과적 개입의 효과를 예측하고 관련 정책을 수립하는 데 근거를 제시한다. 즉, 역학 연구가 단순한 관찰을 넘어 실질적인 개입의 근거를 마련하는 데 필수적인 단계임을 의미한다. 따라서 용량반응 관계는 노출이 질병 발생의 원인이라는 강력한 생물학적 증거를 제공하여 보건 정책 및 규제 설정의 기반이 된다.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>개요</span>"
    ]
  },
  {
    "objectID": "intro.html#선형-및-비선형-관계의-유형",
    "href": "intro.html#선형-및-비선형-관계의-유형",
    "title": "1  개요",
    "section": "3.2 선형 및 비선형 관계의 유형",
    "text": "3.2 선형 및 비선형 관계의 유형\n용량반응 관계는 그 형태에 따라 선형적일 수도 있고 비선형적일 수도 있다.\n\n선형 관계 (Linear Relationship): 가장 단순한 형태로, 노출량 증가에 비례하여 질병 발생 위험이 증가하는 경우이다. 예를 들어, 유해인자 노출이 2배 증가하면 질병 발생도 2배 증가하는 것이 이에 해당한다.\n비선형 관계 (Non-linear Relationships): 실제 세계의 노출-반응 데이터는 종종 선형 관계보다 더 복잡한 패턴을 보인다.\n\n\n\n역치 효과 (Threshold Effects): 특정 노출 수준(역치) 이하에서는 건강 효과가 나타나지 않다가, 역치를 넘어서면 효과가 증가하는 경우이다. 이는 독성학에서 안전 노출 한계를 설정하는 데 흔히 사용되는 모델이다.\n포화 효과 (Saturation Effects): 노출량이 특정 수준에 도달하면 반응이 더 이상 증가하지 않고 평평해지는 경우이다. 이는 생체 내 수용체나 대사 경로가 포화될 때 나타날 수 있다.\nU자형 또는 J자형 관계 (U-shaped or J-shaped Relationships): U자형 관계는 노출량이 낮거나 높을 때 효과가 더 크고, 중간 노출량에서는 효과가 낮은 경우를 의미한다. J자형 관계는 특정 노출량까지는 유익하거나 무해하다가 그 이상에서는 유해한 효과가 나타나는 경우로, 알코올 섭취와 심혈관 질환의 관계에서 관찰될 수 있다.\n\n직업병 역학연구에서 단순한 선형 용량반응 관계만을 가정하는 것은 생물학적 현실을 간과하고 위험 평가를 왜곡할 수 있다. 생체 내의 복잡한 생물학적 메커니즘(예: 수용체 결합, 대사 경로, 세포 독성)은 종종 비선형적인 반응을 유도한다. 예를 들어, 특정 수용체가 포화되면 아무리 노출량을 늘려도 반응이 더 이상 증가하지 않거나, 필수 영양소의 경우 너무 적거나 너무 많아도 문제가 되는 U자형 관계가 나타날 수 있다. 이러한 비선형성을 정확하게 모델링하지 않으면, 안전한 노출 수준을 과대평가하거나 과소평가하여 공중 보건에 심각한 영향을 미칠 수 있다. 따라서 역치, U자형, J자형 등 다양한 비선형 모델을 고려하고 적용하는 것이 보다 정확하고 현실적인 위험 관리를 위해 필수적이다.\n표 2 용량반응 관계 유형 및 특성\n\n\n\n\n\n\n\n\n\n관계 유형\n특징\n생물학적/역학적 의미\n예시\n\n\n선형\n(Linear)\n노출량 증가에 비례하여 반응이 선형적으로 증가\n노출량에 따라 위험이 지속적으로 증가하며, 안전 역치가 없을 수 있음\n방사선 노출과 암 발생\n\n\n역치\n(Threshold)\n특정 노출 수준(역치) 이하에서는 효과가 없고, 역치 초과 시 반응 증가\n안전한 노출 한계(역치)의 존재를 시사, 독성학에서 중요\n중금속 노출과 특정 독성 반응\n\n\n포화\n(Saturation)\n노출량이 특정 수준에 도달하면 반응이 더 이상 증가하지 않고 평탄화\n생체 내 수용체 또는 대사 경로의 포화로 인한 반응 제한\n특정 약물의 최대 효과 도달\n\n\nU자형\n (U-shaped)\n노출량이 낮거나 높을 때 효과가 크고, 중간 노출량에서 효과가 가장 작음\n최적의 노출 수준이 존재함을 시사, 부족과 과잉 모두 유해\n비타민 A 섭취와 선천적 결함\n\n\nJ자형\n (J-shaped)\n특정 노출량까지는 유익하거나 무해하다가, 그 이상에서 유해한 효과가 급증\n저용량의 유익성 또는 무해성 후 고용량의 유해성\n알코올 섭취와 심혈관 질환",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>개요</span>"
    ]
  },
  {
    "objectID": "intro.html#노출과-용량의-관계-체내-흡수-생체이용률-및-독성동태학적-고려사항",
    "href": "intro.html#노출과-용량의-관계-체내-흡수-생체이용률-및-독성동태학적-고려사항",
    "title": "1  개요",
    "section": "4.1 노출과 용량의 관계: 체내 흡수, 생체이용률 및 독성동태학적 고려사항",
    "text": "4.1 노출과 용량의 관계: 체내 흡수, 생체이용률 및 독성동태학적 고려사항\n직업 환경에서 외부 노출(Exposure)과 실제로 생체 내에 도달하여 생물학적 효과를 유발하는 내부 용량(Dose) 간의 중요한 차이가 있다. 용량반응 관계는 유해인자가 생체에 ’도달’하는 양(dose)에 대한 생물학적 반응을 설명하며, 이는 흡수(Absorption), 분포(Distribution), 대사(Metabolism), 배설(Elimination)이라는 독성동태학적(ADME) 과정을 통해 결정된다.\n약물 개발에서 노출-반응 정보는 약물의 안전성과 유효성을 결정하는 핵심이며, 혈중 농도 등과 반응 간의 관계를 확립하는 것이 매우 중요하다. 이러한 원칙은 직업병 역학에서도 유사하게 적용될 수 있다. 직업 환경에서 ’노출’과 ’용량’은 동의어가 아니며, 개인의 생체 내 독성동태학적 특성과 노출 경로에 따라 동일한 외부 노출이 상이한 내부 용량을 유발할 수 있다. 예를 들어, 신장 기능이 저하된 근로자는 특정 화학물질의 배설이 지연되어 동일한 외부 노출에도 불구하고 더 높은 내부 용량을 가질 수 있으며, 이는 독성 반응에 대한 취약성을 증가시킨다. 또한, 노출 경로나 개인의 유전적 다형성, 질병 상태, 생활 습관(흡연, 음주) 등 다양한 요인이 물질의 체내 흡수, 분포, 대사, 배설에 영향을 미쳐 실제 유효 용량을 변화시킬 수 있다.\n외부 노출만으로 용량반응 관계를 추정하는 것은 오차를 유발할 수 있으며, 혈중 농도나 대사산물과 같은 생체 지표(biomarker)를 통한 내부 용량 측정의 중요성이 부각된다. 따라서 내부 용량을 반영하는 생체 지표를 활용하는 것이 용량반응 관계의 정확성을 높이는 데 필수적이다. 그러나 직업병 역학조사에서는 만성 질환의 경우 생체 지표가 내부 용량을 반영하기 어렵기 때문에 환경 노출을 통해 내부 용량을 추정하는 것이 필수적이다.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>개요</span>"
    ]
  },
  {
    "objectID": "intro.html#노출-분포의-특성-정규성-가정의-한계-및-로그정규-분포의-적용",
    "href": "intro.html#노출-분포의-특성-정규성-가정의-한계-및-로그정규-분포의-적용",
    "title": "1  개요",
    "section": "4.2 노출 분포의 특성: 정규성 가정의 한계 및 로그정규 분포의 적용",
    "text": "4.2 노출 분포의 특성: 정규성 가정의 한계 및 로그정규 분포의 적용\n직업 환경 노출 데이터는 일반적으로 정규 분포(Gaussian distribution)를 따른다는 가정이 종종 사용된다. 그러나 실제 산업 위생 샘플링 데이터는 “오른쪽으로 치우친(skewed to the right)” 비대칭 분포를 보이는 경우가 많다.10 이는 노출 값이 0보다 작을 수 없다는 하한선이 존재하기 때문이면서, 노출이 높다고 알려진 경우에 측정한 데이터가 주로 남아 있기 때문이기도 하다.\n직업 환경에서의 노출은 작업 특성, 공정 변화, 개인의 작업 방식 등 다양한 요인에 의해 매우 이질적일 수 있다. 이러한 복잡성은 노출 데이터가 통계적으로 이상적인 정규 분포를 따르기 어렵게 만든다. 노출 분포의 비정규성은 통계적 분석의 가정(예: 선형 회귀 모델의 잔차 정규성)을 위배하여 추정치의 편향이나 비효율성을 초래할 수 있다. 따라서비모수적 방법, 또는 혼합 모델(mixed models)과 같은 고급 통계 기법을 적용하여 이러한 비정규성을 설명하는 것이 필수적이다.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>개요</span>"
    ]
  },
  {
    "objectID": "intro.html#질병-발생의-측정-가능성-및-절단-우측-절단-및-경쟁-위험의-영향",
    "href": "intro.html#질병-발생의-측정-가능성-및-절단-우측-절단-및-경쟁-위험의-영향",
    "title": "1  개요",
    "section": "4.3 질병 발생의 측정 가능성 및 절단: 우측 절단 및 경쟁 위험의 영향",
    "text": "4.3 질병 발생의 측정 가능성 및 절단: 우측 절단 및 경쟁 위험의 영향\n치명적인 질병, 특히 사망과 같은 결과는 한 사람에게 한 번만 측정되며, 사망과 동시에 이후 연구에서는 제외되므로 ’절단(Censoring)’이 발생한다. 이는 생존 분석(Survival Analysis)에서 흔히 발생하는 우측 절단(Right Censoring) 문제다. 우측 절단은 연구 대상자가 연구 기간 동안 관심 사건(예: 질병 발생 또는 사망)을 경험하지 않고 추적 관찰이 종료되거나, 다른 이유로 연구에서 이탈하는 경우 발생한다. 이러한 절단이 ’비정보적(non-informative)’이라는 가정이 충족되지 않으면, 즉 절단된 환자들이 연구에 남아있는 환자들과 다른 위험을 가진다면, Kaplan-Meier 방법과 같은 전통적인 생존 분석 방법은 편향된 추정치를 산출할 수 있다. 예를 들어, 직업성 암의 발생률을 연구하는 경우, 위험 물질에 노출된 후 건강이 악화되어 조기 퇴직한 근로자들이 특수건강검진을 받으면서 계속 근무하는 근로자과 암 발생 위험이 다르다면, 전통적 통계방법의 추정치는 편향될 수 있다. 이러한 편향의 방향은 조기 퇴직한 근로자들의 위험이 연구에 남아있는 근로자들보다 낮은지 높은지에 따라 과소추정 또는 과대추정될 수 있다.\n\n과소추정: 건강이 좋지 않아 조기 퇴직한 근로자들은 실제로 암 발생 위험이 높았지만, 연구에서 제외되면서 전체 집단의 암 발생률이 실제보다 낮게 추정될 수 있다. \n과대추정: 위험을 회피하기 위해 건강할 때 이직한 근로자들은 잠재적으로 위험이 낮았지만, 연구에서 제외되면서 남아있는 고위험군 근로자들로 인해 전체 집단의 암 발생률이 실제보다 높게 추정될 수 있다.\n\n따라서 산업보건 연구에서는 이러한 ’정보적 절단’의 가능성을 항상 염두에 두고, 이를 보정하기 위한 통계적 방법을 적용하는 것이 중요하다.\n더 나아가, ’경쟁 위험(Competing Risks)’은 특정 사건의 발생이 관심 사건의 발생을 불가능하게 만드는 경우를 말한다. 예를 들어, 심혈관 질환으로 인한 사망 시간을 연구할 때, 비심혈관 질환으로 인한 사망은 경쟁 위험이 된다. 사망은 다른 모든 질병 발생에 대한 궁극적인 경쟁 위험이 될 수 있다. 전통적인 생존 분석 방법은 경쟁 위험이 없다는 가정을 전제로 하므로, 경쟁 위험이 존재할 경우 부정확한 추정치를 산출할 수 있다.\n직업병은 종종 오랜 잠복기를 거쳐 발생하며, 사망과 같은 치명적인 결과는 연구 대상자의 추적을 종료시킨다. 이러한 ‘절단’ 데이터는 단순히 제외해서는 안 되며, 적절한 통계적 처리 없이는 질병 발생률이나 위험 추정치가 왜곡될 수 있다. 특히, 사망과 같은 ’경쟁 위험’이 존재할 경우, Kaplan-Meier와 같은 표준 생존 분석은 관심 사건의 발생률을 과대평가하게 된다. 이는 특정 직업병의 발생 위험을 실제보다 높게 평가하여 부적절한 정책 결정을 초래할 수 있다. 따라서 누적 발생 함수(Cumulative Incidence Function, CIF)나 원인별 위험 함수(cause-specific hazard function), 하위분포 위험 함수(subdistribution hazard function)와 같은 경쟁 위험 분석 기법을 적용하여 보다 정확한 인과 추론을 수행해야 한다. 직업병 역학연구에서 우측 절단 및 경쟁 위험은 질병 발생률 및 위험 추정치에 심각한 편향을 초래할 수 있다. 특히 치명적인 질병의 경우, 경쟁 위험 분석을 통해 누적 발생 함수를 추정하는 것이 전통적인 생존 분석 방법보다 더 정확한 정보를 제공한다.\n만성 질환의 발생 시점 불확실성: 코호트 연구에서의 고려사항 및 건강한 근로자 효과\n만성 경과를 갖는 질병, 예를 들어 고혈압의 경우 언제 발생했는지 알 수 없으므로 코호트의 기준 시점에서 이미 발생한 상태일 수 있으며, 이 사람은 유해인자 노출을 피하고 있을 수 있다. 이는 만성 질환의 불분명한 발생 시점과 그로 인한 역학적 추론의 어려움을 지적한다. 만성 질환은 종종 증상이 서서히 나타나므로 정확한 발생 시점을 파악하기 어렵다. 이는 정보 편향(Information Bias) 중 하나인 ’결과 측정 편향(Detection Bias)’으로 이어질 수 있다.18\n또한, 직업 코호트 연구에서는 ’건강한 근로자 효과(Healthy Worker Effect)’라는 특정 형태의 선택 편향(Selection Bias)이 발생할 수 있다.3 일반적으로 고용된 사람들은 건강해야만 일을 할 수 있으므로, 직업군 내 질병률이 일반 인구보다 낮게 나타날 수 있다.18 만성 질환이 있는 사람은 애초에 특정 직업에 진입하지 못하거나, 질병 발생 후 퇴직하여 노출이 중단될 수 있다. 이러한 현상은 노출-질병 연관성을 과소평가하는 결과를 초래할 수 있다.18\n더 나아가, ‘확인 편향(Ascertainment Bias)’ 또는 ’샘플링 편향(Sampling Bias)’은 연구 대상자 선정 과정에서 질병이나 위험 요인이 완벽하게 식별되지 않을 때 발생하는 왜곡을 의미한다. 특히 만성 질환의 경우, 합의된 증거 기반의 사례 정의나 신뢰할 수 있는 진단 검사가 부족할 때 확인 편향의 위험이 커진다. 예를 들어, 병원이나 클리닉에서만 환자를 모집하는 경우, 중증 사례가 과대 대표될 수 있어 실제보다 나쁜 결과를 초래할 수 있다.14 또한, 만성 직업병은 증상이 연령 관련 증상이나 다른 관련 요인(개인 건강 특성, 취미 노출)과 혼동될 수 있어 인과성 확립이 더욱 어렵다. 이전 직업 노출에 대한 정보가 불충분하거나 불완전한 경우가 많다는 점도 문제이다.\n만성 직업병은 급성 질환과 달리 발병 시점이 불명확하고, 노출과 질병 발생 사이에 긴 잠복기가 존재한다. 이로 인해 연구 시작 시점에 이미 질병을 가지고 있는 사람들을 배제하기 어렵고, 이들이 노출을 회피했을 가능성은 선택 편향(건강한 근로자 효과)을 강화하여 노출-질병 연관성을 약화시키는 방향으로 작용할 수 있다. 따라서 만성 질환을 다루는 직업병 역학 연구는 질병 발생 시점을 최대한 정확하게 추정할 수 있는 장기 코호트 연구 설계, 주기적인 건강 검진을 통한 질병 발생 확인, 그리고 건강한 근로자 효과를 보정하기 위한 통계적 방법(예: 내부 비교 집단 설정, 표준화 사망비(SMR) 분석 시 주의)을 신중하게 고려해야 한다.18 만성 직업병 연구에서는 질병 발생 시점의 불확실성과 건강한 근로자 효과, 그리고 확인 편향이 중요한 도전 과제이다. 이러한 편향을 최소화하기 위해 장기 코호트 연구 설계, 질병 발생의 정기적 확인, 그리고 건강한 근로자 효과 및 확인 편향을 고려한 분석 전략이 필수적이다.\n노출과 질병 관련성의 상호작용 및 효과 변형: 특정 집단에서의 질병 발생 및 통계적 처리\n“어떤 노출은 특정 집단에서만 질병을 일으킨다. 극단적인 예로는 야간교대 근무와 유방암의 관련성은 여성에서만 유의하다”는 지적은 ’효과 변형(Effect Modification)’의 전형적인 예시이다.20 효과 변형은 노출이 결과에 미치는 영향이 제3의 변수(효과 변형자)의 수준에 따라 달라지는 경우를 말한다.21 이는 교란(Confounding)과는 본질적으로 다르다. 교란은 제3의 변수가 노출과 결과 모두와 관련되어 있어 관찰된 연관성을 왜곡하는 반면, 효과 변형은 노출의 실제 인과적 효과 자체가 특정 집단에서 다르게 나타나는 것을 의미한다.\n야간 교대 근무와 유방암의 관계는 여성에게만 유의하며, 특히 폐경 전 여성에서 더 두드러질 수 있다는 연구 결과도 있다. 이는 멜라토닌 분비 교란이라는 생물학적 메커니즘과 연관될 수 있다. “모든 노출이 모든 사람에게 동일한 영향을 미치지 않는다”는 것은 직업병 역학의 중요한 원칙이다. 유전적 요인, 기존 질환, 생활 습관, 성별, 연령 등 다양한 개인적 특성이 특정 노출에 대한 민감도를 변화시킬 수 있다. 야간 교대 근무와 유방암의 여성 특이적 연관성은 이러한 효과 변형의 명확한 예시이며, 이는 단순히 노출량을 줄이는 것을 넘어, 특정 취약 집단에 대한 맞춤형 예방 전략(예: 여성 근로자를 위한 야간 근무 제한, 멜라토닌 보충제 연구)의 필요성을 시사한다. 이는 ’정밀 역학(Precision Epidemiology)’의 개념으로 확장될 수 있으며, 개인의 특성을 고려한 위험 평가 및 관리의 중요성을 강조한다.\n상호작용을 분석하는 방법으로는 회귀 모델에 교차항(product terms)을 포함하거나, 효과 변형자에 따라 데이터를 층화(stratification)하여 각 층별로 노출의 효과를 분석하는 방법이 있다.4 특히, 로지스틱 회귀나 콕스 회귀 분석에서 결과가 흔한 질병(예: 일부 심혈관 질환)인 경우, 층별 오즈비(Odds Ratio, OR)의 차이를 인과적 효과 변형으로 오해할 수 있다는 점에 유의해야 한다. 이는 OR이 질병이 흔할 때 상대 위험(Relative Risk, RR)을 과대평가하기 때문이다. 따라서 모델 선택 시 통계적 적합도뿐만 아니라 생물학적 합리성(Biological Plausibility) 을 기반으로 이루어져야 한다. 노출-질병 관계에 대한 상호작용 및 효과 변형은 특정 집단의 취약성을 나타내며, 이는 용량반응 관계가 보편적이지 않고 특정 인구학적 또는 생물학적 특성에 따라 달라질 수 있음을 의미한다. 이러한 효과 변형을 식별하고 분석하는 것은 개인화된 위험 평가 및 보다 효과적인 직업 보건 정책 수립에 필수적이다.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>개요</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model_II.html",
    "href": "Dose_Response_Model_II.html",
    "title": "3  용량-반응 모델링 및 실습: Gompertz 모델",
    "section": "",
    "text": "3.1 Gompertz 모델의 이론적 배경\n이 챕터에서는 비선형 모델인 고퍼츠(Gompertz) 곡선을 사용하여 용량-반응 관계를 분석하는 방법을 다룹니다. 우리는 ggplot2를 사용해 시각화를 하고, nls.multstart를 이용해 모델을 피팅하며, investr를 사용해 신뢰 구간을 계산할 것입니다.\n고퍼츠 곡선은 시간에 따른 성장 모델로 자주 사용되지만, 용량-반응 관계에서도 유용하게 활용될 수 있습니다. 이 곡선은 S자 형태를 가지며, 다음과 같은 세 가지 핵심 파라미터로 정의됩니다.\nA: 곡선이 도달하는 최대값(asymptote)입니다. 이는 용량이 아무리 증가해도 반응이 더 이상 커지지 않고 수렴하는 지점입니다.\nμ (Mu): 곡선의 기울기가 가장 가파른 지점에서의 최대 변화율(maximum slope)입니다. 이는 용량 변화에 따라 반응이 얼마나 빠르게 변하는지를 나타냅니다.\nλ (Lambda): 반응이 시작되기 전 지연되는 구간(lag-phase)입니다. 즉, 반응이 의미 있는 수준으로 나타나기 시작하는 용량 지점입니다.\n이 파라미터들이 어떻게 곡선 형태를 바꾸는지 시각적으로 확인해 봅시다.\n# 필요한 패키지 로드\nif(!require(\"tidyverse\")) install.packages(\"tidyverse\");library(tidyverse)\nif(!require(\"nls.multstart\")) install.packages(\"nls.multstart\");library(nls.multstart)\nif(!require(\"investr\")) install.packages(\"investr\");library(investr)\n# Gompertz 함수 정의\ngompertz &lt;- function(time, a, mu, lambda) {\n  a * exp(-exp(mu * exp(1) / a * (lambda - time) + 1))\n}\n\n# 파라미터별 Gompertz 곡선 시각화\n# A 값 변화에 따른 곡선\ntibble(time = 1:100) %&gt;%\n  mutate(\n    a10 = gompertz(time, a = 10, mu = 2, lambda = 30),\n    a20 = gompertz(time, a = 20, mu = 2, lambda = 30),\n    a30 = gompertz(time, a = 30, mu = 2, lambda = 30)\n  ) %&gt;%\n  pivot_longer(\n    cols = starts_with(\"a\"),\n    names_to = \"parameter_a\",\n    values_to = \"response\"\n  ) %&gt;%\n  ggplot(aes(x = time, y = response, color = parameter_a)) +\n  geom_line(size = 1.2) +\n  labs(\n    title = \"Gompertz Curve: Varying 'A'\",\n    x = \"Time\",\n    y = \"Response\",\n    color = \"A Value\"\n  ) +\n  theme_minimal()\n# 파라미터별 Gompertz 곡선 시각화\n# Mu 값 변화에 따른 곡선\ntibble(time = 1:100) %&gt;%\n  mutate(\n    mu_1 = gompertz(time, a = 10, mu = 1,   lambda = 30),\n    mu_0.5 = gompertz(time, a = 10, mu = 0.5, lambda = 30),\n    mu_0.3 = gompertz(time, a = 10, mu = 0.3, lambda = 30)\n  ) %&gt;%\n  pivot_longer(\n    cols = starts_with(\"m\"),\n    names_to = \"parameter_a\",\n    values_to = \"response\"\n  ) %&gt;%\n  ggplot(aes(x = time, y = response, color = parameter_a)) +\n  geom_line(size = 1.2) +\n  labs(\n    title = \"Gompertz Curve: Varying 'Mu'\",\n    x = \"Time\",\n    y = \"Response\",\n    color = \"Mu Value\"\n  ) +\n  theme_minimal()\n# 파라미터별 Gompertz 곡선 시각화\n# lamda 값 변화에 따른 곡선\ntibble(time = 1:100) %&gt;%\n  mutate(\n    lamda_30 = gompertz(time, a = 10, mu = 0.5,   lambda = 30),\n    lamda_50 = gompertz(time, a = 10, mu = 0.5, lambda = 50),\n    lamda_70 = gompertz(time, a = 10, mu = 0.5, lambda = 70)\n  ) %&gt;%\n  pivot_longer(\n    cols = starts_with(\"l\"),\n    names_to = \"parameter_a\",\n    values_to = \"response\"\n  ) %&gt;%\n  ggplot(aes(x = time, y = response, color = parameter_a)) +\n  geom_line(size = 1.2) +\n  labs(\n    title = \"Gompertz Curve: Varying 'lamda'\",\n    x = \"Time\",\n    y = \"Response\",\n    color = \"lamda Value\"\n  ) +\n  theme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>**용량-반응 모델링 및 실습: Gompertz 모델**</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model_II.html#시뮬레이션-데이터-생성",
    "href": "Dose_Response_Model_II.html#시뮬레이션-데이터-생성",
    "title": "3  Dose Response Model II",
    "section": "3.2 시뮬레이션 데이터 생성",
    "text": "3.2 시뮬레이션 데이터 생성\n\n# 시뮬레이션 매개변수\nn_people &lt;- 1000\nset.seed(42)\n\n# 1. 코호트 데이터 생성\nsimulated_survival_data &lt;- tibble(\n  id = 1:n_people,\n  start_time = 0,\n  # 재직 기간: 1년 ~ 40년\n  person_year = runif(n_people, min = 1, max = 40),\n  end_time = start_time + person_year,\n  # 평균 노출량: 0.5 ~ 10.0\n  average_dose = runif(n_people, min = 0.5, max = 10)\n) %&gt;%\n  # 누적 노출량 계산\n  mutate(cumulative_dose = person_year * average_dose) %&gt;%\n  # 누적 노출량에 따라 사건(event) 발생 확률 할당\n  # 로지스틱 함수를 사용하여 누적 노출량이 높을수록 event 발생 확률 증가\n  mutate(event_prob = 1 / (1 + exp(-0.017 * (cumulative_dose - 200)))) %&gt;%\n  # event_prob에 따라 무작위로 event 할당 (1 = 사건 발생, 0 = 중단)\n  mutate(event = rbinom(n(), size = 1, prob = event_prob))\n\n\n# 1. 누적 노출량을 5개 구간으로 나누기\nbinned_data &lt;- simulated_survival_data %&gt;%\n  mutate(\n    cumulative_dose_bin = cut(cumulative_dose, \n                              breaks = quantile(cumulative_dose, probs = 0:6/6),\n                              include.lowest = TRUE,\n                              labels = c(\"Q1\", \"Q2\", \"Q3\", \"Q4\", \"Q5\", \"Q6\"))\n  ) %&gt;%\n  # 2. 각 구간별 사건 발생 비율 계산\n  group_by(cumulative_dose_bin) %&gt;%\n  summarise(\n    total_people = n(),\n    total_events = sum(event),\n    event_proportion = total_events / total_people,\n    .groups = \"drop\"\n  )\n# 사건(event) 발생 수 확인\nevent_count &lt;- sum(simulated_survival_data$event)\ncat(\"생성된 총 인원수:\", n_people, \"\\n\", \n    \"발생된 총 사건 수:\", event_count, \" (약 300개)\\n\"\n)\n\n생성된 총 인원수: 1000 \n 발생된 총 사건 수: 245  (약 300개)\n\n\n시뮬레이션된 노출 집단에 대해서 시각화를 해보겠습니다.\n\nggplot(binned_data, aes(x = cumulative_dose_bin, y = event_proportion, group = 1)) +\n  geom_point(size = 3, color = \"dodgerblue\") +\n  geom_line(color = \"dodgerblue\", size = 1) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"black\", linetype = \"dashed\") + # 추세선 추가\n  labs(\n    title = \"누적 노출량에 따른 사건 발생 비율\",\n    subtitle = \"직업 코호트 시뮬레이션 데이터\",\n    x = \"누적 노출량 구간 (Q1-Q6)\",\n    y = \"사건 발생 비율\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(hjust = 0.5),\n        plot.subtitle = element_text(hjust = 0.5))\n\n\n\n\n\n\n\n\n누적 노출량을 3개 그룹으로 나누어 보겠습니다.\n\nsimulated_survival_data &lt;- simulated_survival_data %&gt;%\n  mutate(\n    dose_group = case_when(\n      cumulative_dose &lt;= quantile(cumulative_dose, 0.33) ~ \"Low\",\n      cumulative_dose &gt; quantile(cumulative_dose, 0.33) & cumulative_dose &lt;= quantile(cumulative_dose, 0.66) ~ \"Medium\",\n      TRUE ~ \"High\"\n    )\n  ) %&gt;%\n  filter(person_year &lt;38)\n\n\nkm_fit &lt;- survfit(Surv(end_time, event) ~ dose_group, data = simulated_survival_data)\nggsurvplot(\n  km_fit,\n  data = simulated_survival_data,\n  risk.table = TRUE,       # 위험 테이블 포함\n  pval = TRUE,             # P-value 표시\n  conf.int = TRUE,         # 신뢰 구간 표시\n  xlab = \"Time in Months\",  # x축 레이블\n  ylab = \"Survival Probability\", # y축 레이블\n  title = \"누적 노출량 그룹별 생존 곡선\",\n  legend.title = \"Dose Group\",\n  legend.labs = c(\"High\", \"Low\", \"Medium\"), # 그룹 레이블\n  palette = c(\"red\", \"blue\", \"green\")\n)\n\n\n\n\n\n\n\n\n\nkm_fit &lt;- survfit(Surv(end_time, event) ~ dose_group, data = simulated_survival_data)\nggsurvplot(\n  km_fit,\n  data = simulated_survival_data,\n  fun = \"event\",\n  risk.table = TRUE,       # 위험 테이블 포함\n  pval = TRUE,             # P-value 표시\n  conf.int = TRUE,         # 신뢰 구간 표시\n  xlab = \"Time in Months\",  # x축 레이블\n  ylab = \"Survival Probability\", # y축 레이블\n  title = \"누적 노출량 그룹별 생존 곡선\",\n  legend.title = \"Dose Group\",\n  legend.labs = c(\"High\", \"Low\", \"Medium\"), # 그룹 레이블\n  palette = c(\"red\", \"blue\", \"green\")\n)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Dose Response Model II</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model_II.html#gompertz-모델의-이론적-배경",
    "href": "Dose_Response_Model_II.html#gompertz-모델의-이론적-배경",
    "title": "3  용량-반응 모델링 및 실습: Gompertz 모델",
    "section": "",
    "text": "3.1.0.1 데이터 생성 및 기초 시각화\n이제 실제 연구와 유사한 가상의 용량-반응 데이터를 생성하고 tibble로 변환하여 ggplot2로 시각화해 봅시다. 이 과정은 데이터의 전반적인 패턴을 탐색하고, 어떤 모델을 적용해야 할지 가늠하는 데 필수적입니다.\n\n# 데이터 생성\nset.seed(0)\ndose &lt;- seq(0, 10, 0.1)\npb &lt;- c(rnorm(50, 0, 0.001), rnorm(30, 0, 0.01), rnorm(10, 0.1, 0.05), rnorm(11, -0.1, 0.05))\nresp &lt;- 1 / (1 + exp(-(dose - 5))) + rnorm(length(dose), 0, 0.1) + pb\n\n# tibble 생성 및 시각화\ncohort &lt;- tibble(dose, resp, pb)\n\nggplot(cohort, aes(x = dose, y = resp)) +\n  geom_point(color = \"skyblue\", alpha = 0.7) +\n  labs(\n    title = \"Dose-Response Relationship\",\n    subtitle = \"가상의 용량-반응 데이터\",\n    x = \"용량 (Dose)\",\n    y = \"반응 (Response)\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(face = \"bold\"))\n\n\n\n\n\n\n\n\n\n\n3.1.0.2 Gompertz 모델 피팅 및 신뢰 구간 시각화\nnls() 함수는 비선형 모델을 피팅하는 데 사용되지만, 초기값에 매우 민감합니다. (2019년 강의록) 이러한 문제를 해결하기 위해, 우리는 여러 초기값을 자동으로 시도하는 nls.multstart() 함수를 사용하여 더 안정적으로 최적의 모델을 찾을 것입니다. 모델이 피팅되면, investr 패키지를 이용해 예측 곡선과 함께 95% 신뢰 구간(Confidence Interval)을 시각화할 수 있습니다.\n\n# nls_multstart를 사용하여 고퍼츠 모델 피팅\nnls_fit &lt;- nls_multstart(\n  resp ~ gompertz(dose, a, mu, lambda),\n  data = cohort,\n  start_lower = c(a = 0, mu = 0, lambda = 0),\n  start_upper = c(a = 2, mu = 1, lambda = 10),\n  iter = 250\n)\n\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\n\n# 모델 결과 요약\nprint(summary(nls_fit))\n\n\nFormula: resp ~ gompertz(dose, a, mu, lambda)\n\nParameters:\n       Estimate Std. Error t value Pr(&gt;|t|)    \na       1.00934    0.03107   32.48   &lt;2e-16 ***\nmu      0.29314    0.02754   10.64   &lt;2e-16 ***\nlambda  3.20596    0.15811   20.28   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1106 on 98 degrees of freedom\n\nNumber of iterations to convergence: 23 \nAchieved convergence tolerance: 1.49e-08\n\n# 모델 피팅 결과 시각화\n# 신뢰 구간 계산\ncohort_ci &lt;- investr::predFit(\n  nls_fit, \n  newdata = cohort,\n  interval = \"confidence\", \n  level = 0.95\n) %&gt;%\n  as_tibble() %&gt;%\n  mutate(dose = cohort$dose)\n\nggplot(cohort, aes(x = dose, y = resp)) +\n  geom_point(alpha = 0.6) +\n  geom_line(data = cohort_ci, aes(y = fit), color = \"red\", size = 1.2) +\n  geom_ribbon(data = cohort_ci, aes(ymin = lwr, ymax = upr, y = fit), fill = \"red\", alpha = 0.2) +\n  labs(title = \"Gompertz 모델 피팅 및 95% 신뢰 구간\", x = \"용량 (Dose)\", y = \"반응 (Response)\") +\n  theme_minimal(base_size = 14)\n\n\n\n\n\n\n\n\n\n\n3.1.0.3 실습 3: 모델 비교 및 외삽(Extrapolation) 논의\n고퍼츠 모델 외에 다항식 모델을 피팅하여 두 모델의 적합도를 비교해봅시다. AIC(Akaike Information Criterion)는 모델의 복잡성과 적합도를 함께 고려하는 지표로, AIC 값이 낮을수록 더 좋은 모델로 평가됩니다. AIC를 통해 어떤 모델이 데이터에 가장 잘 맞는지 통계적으로 평가할 수 있습니다.\n이 그래프를 보면, 모델의 외삽(Extrapolation) 결과가 어떻게 달라지는지 알 수 있습니다. 데이터가 없는 구간(dose -5 ~ 0 또는 10 ~ 15)에서 다항식 모델은 실제와 동떨어진 예측을 하는 반면, Gompertz 모델은 현실적인 포화 곡선을 유지합니다. 이는 모델 선택이 데이터 범위 밖의 위험을 평가하는 데 얼마나 중요한지를 시사합니다.\n\n# 다항식 모델 피팅\npoly2_fit &lt;- glm(resp ~ poly(dose,2),data = cohort)\npoly3_fit &lt;- glm(resp ~ poly(dose,3),data = cohort)\n\n# AIC를 이용한 모델 비교\nAIC(nls_fit, poly2_fit, poly3_fit)\n\n          df        AIC\nnls_fit    4 -153.22741\npoly2_fit  4  -87.32223\npoly3_fit  5 -154.38409\n\n# 모델 외삽(extrapolation) 결과 시각화\nextrapolated_data &lt;- tibble(dose = seq(-5, 15, length.out = 100))\n\nextrapolated_data &lt;- extrapolated_data %&gt;%\n  mutate(\n    gompertz_pred = predict(nls_fit, newdata = .),\n    poly2_pred = predict(poly2_fit, newdata = .), \n    poly3_pred = predict(poly3_fit, newdata = .)\n  )\n\nggplot(cohort, aes(x = dose, y = resp)) +\n  geom_point(alpha = 0.6) +\n  geom_line(data = extrapolated_data, aes(y = gompertz_pred, color = \"Gompertz\"), size = 1.2) +\n  geom_line(data = extrapolated_data, aes(y = poly2_pred, color = \"Polynomial 2\"), size = 1.2) +\n  geom_line(data = extrapolated_data, aes(y = poly3_pred, color = \"Polynomial 3\"), size = 1.2) +\n  geom_vline(xintercept = range(cohort$dose), linetype = \"dashed\", color = \"gray\") +\n  scale_color_manual(values = c(\"Gompertz\" = \"red\", \"Polynomial 2\" = \"blue\", \"Polynomial 3\" = \"orange\")) +\n  labs(title = \"모델 외삽 예측 비교\", x = \"용량 (Dose)\", y = \"반응 (Response)\", color = \"모델\") +\n  theme_minimal(base_size = 14)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>**용량-반응 모델링 및 실습: Gompertz 모델**</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model_III.html",
    "href": "Dose_Response_Model_III.html",
    "title": "4  비선형 모델 비교과 MixedModel",
    "section": "",
    "text": "4.1 여러 비선형 모델 비교 및 선택\n이 챕터에서는 앞서 배운 기본적인 고퍼츠(Gompertz) 모델을 넘어, 실제 연구에서 마주하는 복잡한 상황을 다루는 방법을 알아봅니다. 특히, 여러 비선형 모델을 비교하고, 교대 근무와 같은 중요한 공변량이 용량-반응 관계에 미치는 영향을 어떻게 분석하는지 배울 것입니다.\n용량-반응 관계는 언제나 S자형 곡선(Gompertz, Logistic)만 따르는 것은 아닙니다. 때로는 힐(Hill) 모델과 같이 민감도가 다른 곡선이 더 적합할 수 있습니다. 우리가 가진 데이터에 어떤 모델이 가장 잘 맞는지 평가하는 것은 매우 중요합니다.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>비선형 모델 비교과 MixedModel</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model_III.html#여러-비선형-모델-비교-및-선택",
    "href": "Dose_Response_Model_III.html#여러-비선형-모델-비교-및-선택",
    "title": "4  비선형 모델 비교과 MixedModel",
    "section": "",
    "text": "4.1.1 모델 이론\n\n로지스틱 모델: y(dose)=fraca1+exp(−b(dose−c))\n\nS자형 곡선을 설명하는 가장 기본적인 모델입니다. 특히, 질병 발생 여부와 같은 이항형 결과를 다룰 때 많이 사용됩니다\na: 최대 반응값\nb: 곡선의 기울기(성장률)\nc: LD50(반응이 50%가 되는 용량)\n\n힐 모델: y(dose)=fracacdotdosebcb+doseb\n\n로지스틱 모델과 비슷하지만, 곡선의 기울기를 조절하는 파라미터가 추가되어, 용량-반응 관계의 민감도를 더 세밀하게 표현할 수 있습니다.\nb: 힐 계수(Hill Coefficient), 곡선 기울기(민감도)\nc: LD50(반응이 50%가 되는 용량)\n\n\n\n\n4.1.2 실습: 모델 피팅 및 비교\n세 가지 모델(Gompertz, Logistic, Hill)을 모두 데이터에 피팅하고, 통계적인 지표인 AIC(Akaike Information Criterion) 값을 비교하여 어떤 모델이 가장 적합한지 평가해 봅시다. AIC는 모델의 복잡성과 데이터에 대한 적합도를 동시에 고려하여, AIC 값이 가장 낮은 모델이 가장 좋은 모델입니다.\n\n# Gompertz 모델 함수\ngompertz &lt;- function(dose, a, mu, lambda) {\n  a * exp(-exp(mu * exp(1) / a * (lambda - dose) + 1))\n}\n\n# 로지스틱 모델 함수\nlogistic &lt;- function(dose, a, b, c) {\n  a / (1 + exp(-b * (dose - c)))\n}\n\n# 힐 모델 함수\nhill &lt;- function(dose, a, b, c) {\n  (a * dose^b) / (c^b + dose^b)\n}\n\n# LD50 계산 함수\nld50_logistic &lt;- function(model) {\n  coefs &lt;- coef(model)\n  ld50 &lt;- coefs[\"c\"]\n  return(ld50)\n}\n\n# 데이터 생성\nset.seed(0)\ndose &lt;- seq(0, 10, 0.1)\npb &lt;- c(rnorm(50, 0, 0.001), rnorm(30, 0, 0.01), rnorm(10, 0.1, 0.05), rnorm(11, -0.1, 0.05))\nresp &lt;- 1 / (1 + exp(-(dose - 5))) + rnorm(length(dose), 0, 0.1) + pb\ncohort &lt;- tibble(dose, resp)\n\n# 여러 모델 피팅\nnls_gompertz &lt;- nls_multstart(\n  resp ~ gompertz(dose, a, mu, lambda),\n  data = cohort,\n  start_lower = c(a = 0, mu = 0, lambda = 0),\n  start_upper = c(a = 2, mu = 1, lambda = 10),\n  iter = 250 # iter 인자 추가\n)\n\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\n\nnls_logistic &lt;- nls_multstart(\n  resp ~ logistic(dose, a, b, c),\n  data = cohort,\n  start_lower = c(a = 0, b = 0, c = 0),\n  start_upper = c(a = 2, b = 1, c = 10),\n  iter = 250 # iter 인자 추가\n)\n\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\nError in nlsModel(formula, mf, start, wts) : \n  singular gradient matrix at initial parameter estimates\n\nnls_hill &lt;- nls_multstart(\n  resp ~ hill(dose, a, b, c),\n  data = cohort,\n  start_lower = c(a = 0, b = 0, c = 0),\n  start_upper = c(a = 2, b = 10, c = 10),\n  iter = 250 # iter 인자 추가\n)\n\n\n# AIC 값 비교\naic_values &lt;- AIC(nls_gompertz, nls_logistic, nls_hill)\nprint(aic_values)\n\n             df       AIC\nnls_gompertz  4 -153.2274\nnls_logistic  4 -160.6434\nnls_hill      4 -156.0963\n\n\n제공된 코드의 AIC 비교 결과를 보면 다음과 같습니다.\n\n\n\n모델\nAIC 값\n\n\nnls_gompertz\n-153.2274\n\n\nnls_logistic\n-160.6434\n\n\nnls_hill\n-156.0963\n\n\n\n이 결과를 보면\nLogistic 모델의 AIC가 -160.6434로 가장 낮습니다. 이는 우리가 생성한 데이터에 대해 로지스틱 모델이 다른 두 모델보다 통계적으로 더 우수한 적합도를 보인다는 것을 의미합니다.\n이 결과를 그래프로 시각화해 보면, 세 개의 곡선이 데이터에 어떻게 피팅되는지 한눈에 확인할 수 있습니다.\n\n# 모든 모델을 한 그래프에 시각화\ncohort_predicted &lt;- cohort %&gt;%\n  mutate(\n    Gompertz = predict(nls_gompertz),\n    Logistic = predict(nls_logistic),\n    Hill = predict(nls_hill)\n  ) %&gt;%\n  pivot_longer(\n    cols = c(Gompertz, Logistic, Hill),\n    names_to = \"Model\",\n    values_to = \"Predicted_Response\"\n  )\n\nggplot(cohort, aes(x = dose, y = resp)) +\n  geom_point(alpha = 0.5) +\n  geom_line(data = cohort_predicted, aes(y = Predicted_Response, color = Model), size = 1.2) +\n  labs(\n    title = \"다양한 비선형 모델 비교\",\n    x = \"용량 (Dose)\",\n    y = \"반응 (Response)\",\n    color = \"모델\"\n  ) +\n  theme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>비선형 모델 비교과 MixedModel</span>"
    ]
  },
  {
    "objectID": "Dose_Response_Model_III.html#실제-데이터의-변수-고려-공변량covariates-분석",
    "href": "Dose_Response_Model_III.html#실제-데이터의-변수-고려-공변량covariates-분석",
    "title": "4  비선형 모델 비교과 MixedModel",
    "section": "4.2 실제 데이터의 변수 고려: 공변량(Covariates) 분석",
    "text": "4.2 실제 데이터의 변수 고려: 공변량(Covariates) 분석\n이제 한 걸음 더 나아가, 교대 근무와 같은 공변량이 용량-반응 관계에 어떤 영향을 미치는지 분석해 봅시다. 실제 직업 환경에서는 개인의 근무 형태나 생활 습관 등이 유해물질 노출에 대한 질병 반응에 영향을 줄 수 있습니다. 우리는 교대 근무 여부에 따라 과로와 질병 반응 간의 관계가 달라지는 상황을 시뮬레이션했습니다.\n\n4.2.1 시뮬레이션: 공변량 효과\n우리는 두 그룹의 가상 데이터를 만들었습니다.\n\n비교대 근무자: 과로가 증가할수록 질병 반응이 선형적으로 증가하는 그룹입니다.\n교대 근무자: 과로가 증가할수록 질병 반응이 고퍼츠 곡선을 따라 증가하는 그룹입니다. 즉, 특정 시점부터 질병 반응이 급격하게 증가하는 패턴을 보입니다.\n\n혼합 효과 모델은 이 두 그룹의 관계를 하나의 통합된 모델로 분석하는 도구입니다.\n\n# nlme 패키지 로드\nlibrary(nlme)\nlibrary(tidyverse)\n\n# Gompertz 모델 함수\ngompertz &lt;- function(dose, a, mu, lambda) {\n  a / (1 + exp(-mu * (dose - lambda)))\n}\n\n# 데이터 생성\nset.seed(123)\ndose &lt;- seq(0, 10, 0.1)\nn_dose &lt;- length(dose)\n\n# 비 교대 근무자 그룹의 반응 (느린 Gompertz 곡선)\nresp_nonshift &lt;- gompertz(dose, a = 1.2, mu = 0.5, lambda = 5) + rnorm(n_dose, 0, 0.05)\n\n# 교대 근무자 그룹의 반응 (더 가파른 Gompertz 곡선)\nresp_shift &lt;- gompertz(dose, a = 1.2, mu = 0.8, lambda = 5) + rnorm(n_dose, 0, 0.05)\n\n# 두 그룹의 데이터를 하나의 데이터프레임으로 결합\ncohort_full &lt;- tibble(\n  dose = rep(dose, 2),\n  shift = factor(c(rep(\"비교대\", n_dose), rep(\"교대\", n_dose))),\n  resp = c(resp_nonshift, resp_shift)\n)\n# 데이터 시각화\nggplot(cohort_full, aes(x = dose, y = resp, color = shift)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"gam\", formula = y ~ s(x), se = FALSE) +\n  labs(\n    title = \"교대 근무 여부에 따른 용량-반응 관계 (시뮬레이션 탐색)\",\n    x = \"과로 (Dose)\",\n    y = \"질병 반응 (Response)\",\n    color = \"교대근무 여부\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(face = \"bold\"))\n\n\n\n\n\n\n\n\n\n# 혼합 효과 모델 피팅\n# 두 그룹 모두 Gompertz 곡선을 따르는 가정을 반영합니다.\n# fixed = a + mu + lam ~ shift는 shift 그룹에 따라 파라미터 a, mu, lam이 달라지도록 설정합니다.\nnlme_fit &lt;- nlme(\n  model = resp ~ a / (1 + exp(-(mu * (dose - lam)))),\n  data = cohort_full,\n  fixed = a + mu + lam ~ shift, \n  random = a + mu + lam ~ 1 | shift,\n  start = c(a = c(1.2, 1.2), mu = c(0.5, 0.8), lam = c(5, 5)), \n  control = list(pnlsTol = 0.01)\n)\n# 모델 결과 요약\n#summary(nlme_fit)\n\n# 모델 예측값 계산\ncohort_full$nlme_pred &lt;- predict(nlme_fit)\n\n# 혼합 효과 모델 시각화\nggplot(cohort_full, aes(x = dose, y = resp, color = shift)) +\n  geom_point(alpha = 0.5) +\n  geom_line(aes(y = nlme_pred, group = shift), size = 1.2) +\n  labs(\n    title = \"혼합 효과 모델 결과 (그룹별 파라미터)\",\n    x = \"용량 (Dose)\",\n    y = \"질병 반응 (Response)\",\n    color = \"교대근무 여부\"\n  ) +\n  theme_minimal(base_size = 14)\n\n\n\n\n\n\n\n\n\nsummary(nlme_fit)\n\nNonlinear mixed-effects model fit by maximum likelihood\n  Model: resp ~ a/(1 + exp(-(mu * (dose - lam)))) \n  Data: cohort_full \n        AIC       BIC   logLik\n  -634.3112 -591.3037 330.1556\n\nRandom effects:\n Formula: list(a ~ 1, mu ~ 1, lam ~ 1)\n Level: shift\n Structure: General positive-definite, Log-Cholesky parametrization\n                StdDev       Corr         \na.(Intercept)   9.047340e-07 a.(In) m.(In)\nmu.(Intercept)  1.149202e-06 0            \nlam.(Intercept) 1.844210e-06 0      0     \nResidual        4.719949e-02              \n\nFixed effects:  a + mu + lam ~ shift \n                    Value  Std.Error  DF  t-value p-value\na.(Intercept)    1.195727 0.01404366 195 85.14359  0.0000\na.shift비교대    0.029480 0.03142533 195  0.93811  0.3493\nmu.(Intercept)   0.835771 0.02898145 195 28.83812  0.0000\nmu.shift비교대  -0.345475 0.03510659 195 -9.84075  0.0000\nlam.(Intercept)  5.000389 0.05323858 195 93.92415  0.0000\nlam.shift비교대  0.082515 0.14068227 195  0.58653  0.5582\n Correlation: \n                a.(In) ashft대 m.(In) mshft대 lm.(I)\na.shift비교대   -0.447                              \nmu.(Intercept)  -0.685  0.306                       \nmu.shift비교대   0.565 -0.680  -0.826               \nlam.(Intercept)  0.770 -0.344  -0.527  0.435        \nlam.shift비교대 -0.291  0.910   0.200 -0.581  -0.378\n\nStandardized Within-Group Residuals:\n        Min          Q1         Med          Q3         Max \n-2.53316379 -0.67449163 -0.07048116  0.62151401  3.28479392 \n\nNumber of Observations: 202\nNumber of Groups: 2 \n\n# p-value 계산 및 출력 (tidy형식)\n# fixed effects 결과를 추출합니다.\n#fixed_effects &lt;- summary(nlme_fit)$tTable\n# p-value를 계산합니다. (t-value와 자유도(DF)를 이용)\n#p_values &lt;- 2 * (1 - pt(abs(fixed_effects[, \"t-value\"]), fixed_effects[, \"DF\"]))\n# 계산된 p-value를 기존 summary 출력에 추가하여 보여줍니다.\n#fixed_effects_with_p &lt;- cbind(fixed_effects, `p-value` = p_values)\n#print(fixed_effects_with_p)\n\n혼합 효과 모델은 단순히 두 곡선을 그리는 것을 넘어, 두 그룹이 통계적으로 어떻게 다른지를 알려줍니다. summary(nlme_fit) 결과를 자세히 해석해 보겠습니다.\n\n\n\n\n\n\n\n\n\n\n효과\n파라미터\n값 (Value)\np-value\n의미\n\n\n고정 효과\na.(Intercept)\n1.195727\n0.0000\n**비교대 근무자의 최대 반응값(a)**입니다.\n\n\n\na.shift비교대\n0.029480\n0.3493\n비교대 근무자를 기준으로 교대 근무자의 a 값이 얼마나 다른지를 나타냅니다. p-value가 0.05보다 커서 통계적으로 유의미한 차이가 없습니다.\n\n\n\nmu.(Intercept)\n0.835771\n0.0000\n**교대 근무자의 기울기(mu)**입니다.\n\n\n\nmu.shift비교대\n-0.345475\n0.0000\n교대 근무자를 기준으로 비교대 근무자의 mu 값이 얼마나 다른지를 나타냅니다. p-value가 0.0001로 매우 작아서, 두 그룹의 기울기에는 통계적으로 매우 유의미한 차이가 있습니다.\n\n\n\nlam.(Intercept)\n5.000389\n0.0000\n**교대 근무자의 시작점(lam)**입니다.\n\n\n\nlam.shift비교대\n0.082515\n0.5582\n교대 근무자를 기준으로 비교대 근무자의 lam 값이 얼마나 다른지를 나타냅니다. 통계적으로 유의미한 차이는 없습니다.\n\n\n\n이 결과를 통해 우리는 **‘과로에 대한 질병 반응의 기울기(mu)는 교대 근무자와 비교대 근무자 간에 통계적으로 유의미하게 다르다’**는 결론을 내릴 수 있습니다. 이는\n교대 근무 여부라는 공변량이 용량-반응 관계에 중요한 영향을 미친다는 강력한 증거가 됩니다.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>비선형 모델 비교과 MixedModel</span>"
    ]
  }
]